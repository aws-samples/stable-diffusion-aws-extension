{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Overview","text":"<p>The Extension for Stable Diffusion on AWS solution helps customers migrate their existing Stable Diffusion model training, inference, and finetuning workloads from on-premises servers to Amazon SageMaker using extension and CloudFormation template. By leveraging elastic resources in the cloud, it accelerates model iteration and avoids performance bottlenecks associated with single-server deployments.</p> <p>This implementation guide provides an overview of the solution, its reference architecture and components, considerations for planning the deployment, configuration steps for deploying the solution to the Amazon Web Services (AWS) Cloud. </p>"},{"location":"concepts/","title":"Concepts","text":"<p>This section describes key concepts and defines terminology specific to this solution: </p>"},{"location":"cost/","title":"Cost","text":"<p>You are responsible for the cost of AWS services used when running this solution. </p> <p>As of June 2023, for example, based on generating 1000 images per day and training Dreambooth 10 times as the benchmark, the estimated cost of using this solution in the US West (Oregon) (us-west-2) is $583 per month.</p> Service Usage Cost/Month AWS Lambda Generate 1000 images per day for inference, and an average Lambda runtime of 200ms, with a memory size of 1024MB $0.00 Amazon API Gateway Generate 1000 images per day for inference\uff0cwith an average of approximately 10 backend API calls per image, totaling 300,000 calls $0.30 Amazon Simple Storage Service (S3) 1000GB $23 Amazon DynamoDB 2GB storage $0.50 Step Functions Step function is used when deploying Amazon SageMaker Endpoint and model training\uff0c 600 calls of step function\uff0con average 15 state changes per workflow $0.13 Amazon CloudWatch writing 10GB of log data per month $5.04 Amazon Sagemaker Training Storage (General Purpose SSD (gp2)), Instance name (ml.g4dn.2xlarge), Number of training jobs per month (300), Number of instances per job (1), Hour(s) per instance per job (1) $282 Amazon Sagemaker Inference(GPU) Number of models per endpoint (1), Storage (General Purpose SSD (gp2)), Instance name (ml.g4dn.2xlarge), Number of instances per endpoint (1), Endpoint hour(s) per day (10), Endpoint day(s) per month (22), Number of models deployed (1) $206 Amazon Sagemaker Inference(CPU) Number of models per endpoint (1), Storage (General Purpose SSD (gp2)), Instance name (ml.r5.xlarge), Number of models deployed (1), Number of instances per endpoint (1), Endpoint hour(s) per day (10), Endpoint day(s) per month (22) $66 Total $583"},{"location":"faq/","title":"Frequently Asked Questions","text":""},{"location":"faq/#general","title":"General","text":"<p>Q: What is Extension for Stable Diffusion on AWS?</p> <p>Extension for Stable Diffusion on AWS is an AWS solution that aims to assists customers migrate their Stable Diffusion model training, inference, and finetuning workloads on Stable Diffusion WebUI from local servers to Amazon SageMaker by providing extension and AWS CloudFormation template. By leveraging elastic cloud resources, this solution accelerates model iteration and mitigates performance bottlenecks associated with single-server deployments. </p> <p>Q: What are the native features/third-party extensions of Stable Diffusion WebUI supported by this solution?</p> <p>This solution supports multiply native features/third-party extensions of Stable Diffusion WebUI. More details can be found at Features and Benefits.</p> <p>Q: What is the licence of this solution?</p> <p>This solution is provided under the Apache-2.0 license. It is a permissive free software license written by the Apache Software Foundation. It allows users to use the software for any purpose, to distribute it, to modify it, and to distribute modified versions of the software under the terms of the license, without concern for royalties.</p> <p>Q: How can I submit a feature request or bug report?</p> <p>You can submit feature requests and bug report through the GitHub issues. Here are the templates for feature request, bug report.</p>"},{"location":"faq/#installation-and-configuration","title":"Installation and Configuration","text":"<p>Q: Is there a specific order for installing third-party plugins and the plugins for this solution?</p> <p>Currently, it is recommended that users install the third-party extensions supported by this solution before installing the solution's own extension. However, the installation order can be changed as well. In that case, a restart of the WebUI is required to ensure the successful functioning of the features.</p> <p>Q: After successfully installing the web UI, I am unable to access it in my browser. How can I resolve this?</p> <p>Before attempting to access the webUI link in your browser, please ensure that the necessary ports are open and not being blocked by a firewall.</p> <p>Q: How can I update the solution?</p> <p>Currently, it is recommended that users avoid frequently updating solutions by deploying stacks through CloudFormation. If updates are necessary, it is advised to uninstall the existing solution stack and then deploy a new stack based on the CloudFormation template.</p>"},{"location":"faq/#pricing","title":"Pricing","text":"<p>Q: How will I be charged and billed for the use of this solution?</p> <p>The solution is free to use, and you are responsible for the cost of AWS services used while running this solution. You pay only for what you use, and there are no minimum or setup fees. Refer to the Centralized Logging with OpenSearch Cost section for detailed cost estimation.</p>"},{"location":"notices/","title":"Notices","text":"<p>Customers are responsible for making their own independent assessment of the information in this document. This document: (a) is for informational purposes only, (b) represents Amazon Web Services current product offerings and practices, which are subject to change without notice, and (c) does not create any commitments or assurances from Amazon Web Services and its affiliates, suppliers or licensors. Amazon Web Services products or services are provided \u201cas is\u201d without warranties, representations, or conditions of any kind, whether express or implied. Amazon Web Services responsibilities and liabilities to its customers are controlled by Amazon Web Services agreements, and this document is not part of, nor does it modify, any agreement between Amazon Web Services and its customers.</p> <p>The Extension for Stable Diffusion on AWS solution is licensed under the terms of the Apache License Version 2.0 available at The Apache Software Foundation</p> <p>This guidance is for informational purposes only.  You should still perform your own independent assessment, and take measures to ensure that you comply with your own specific quality control practices and standards, and the local rules, laws, regulations, licenses and terms of use that apply to you, your content, and the third-party generative AI service referenced in this guidance.  Amazon Web Services has no control or authority over the third-party generative AI service referenced in this guidance, and does not make any representations or warranties that the third-party generative AI service is secure, virus-free, operational, or compatible with your production environment and standards. Amazon Web Services does not make any representations, warranties or guarantees that any information in this guidance will result in a particular outcome or result.   </p>"},{"location":"revisions/","title":"Revisions","text":"Date Version Changes CloudFormation Template 2023/8/14 V1.1.0 - Support webUI V1.5.1  - Support Stable Diffusion XL 1.0  - Support VAE  - Support upload model from local to S3   - Support Multi-controlnet  - Support deployauto scale SageMaker Endpoint  - Add filters for Inference Job list V1.1.0 2023/7/14 V1.0.1 - Upgrade the version support of webUI to V1.4.0   - Upgrade the version support of ControlNet to V1.1.227   - Upgrade the version support of Dreambooth to V1.0.14    - Support txt2img API Direct call  - Support full features in img2img except batch  - Support full features in ControlNet except multi-ControlNet  - Auto-refresh inference results in Output section  - Support filter in Inference Job ID  - Support rollback or update the middleware  - Bugs fix V1.0.1 2023/6/16 V1.0.0 Initial release V1.0.0"},{"location":"template/","title":"Template","text":"<p>To automate deployment, this solution uses the following AWS CloudFormation templates, which you can download before deployment:</p> <p>[xxx.template]: Use this template to launch the solution and all associated components. The default configuration deploys [Amazon API Gateway][api-gateway], [Amazon Lambda][lambda], [Amazon Batch][Batch], [Amazon S3][s3], [Amazon EFS][efs] and [Amazon Batch][Batch], but you can customize the template to meet your specific needs.</p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<p>The following help you to fix errors or problems that you might encounter when using Extension for Stable Diffusion on AWS.</p> <p>Error: It presents error message 'RuntimeError: \"LayerNormKernelImpl\" not implemented for 'Half'' when I use txt2img inference function</p> <p>The error appears when deploying webUI frontend. It's recommended to start webUI adding <code>--precision full --no-half</code> <pre><code>./webui.sh --skip-torch-cuda-test --precision full --no-half\n</code></pre></p> <p>Error: I cannot install python venv on Ubuntu using <code>python3 -m venv env</code></p> <p>The error comes out when your system's default is Python 3.9, and Ubunton 20.04 is Python 3.8. User can install venv package using <code>sudo apt install python3.8-venv</code> to explicitly mentioning the full version of Python.</p>"},{"location":"uninstall/","title":"Uninstall Extension for Stable Diffusion on AWS","text":"<p>Warning</p> <p>Before uninstalling the solution, please manually delete all the Amazon SageMaker Endpoints deployed by this solution, referring to Delete deployed endpoint in Main tab. By uninstalling the solution, the DynamoDB tables that indicates the model training, finetuning and inference logs and mapping relationship, AWS Lambda related functions, AWS Step Functions and so on will be deleted simultaneously.</p> <p>To uninstall the Extension for Stable Diffusion on AWS solution, you must delete the AWS CloudFormation stack. </p> <p>You can use either the AWS Management Console or the AWS Command Line Interface (AWS CLI) to delete the CloudFormation stack.</p>"},{"location":"uninstall/#uninstall-the-stack-using-the-aws-management-console","title":"Uninstall the stack using the AWS Management Console","text":"<ol> <li>Sign in to the AWS CloudFormation console.</li> <li>Select this solution\u2019s installation parent stack.</li> <li>Choose Delete.</li> </ol>"},{"location":"uninstall/#uninstall-the-stack-using-aws-command-line-interface","title":"Uninstall the stack using AWS Command Line Interface","text":"<p>Determine whether the AWS Command Line Interface (AWS CLI) is available in your environment. For installation instructions, refer to What Is the AWS Command Line Interface in the AWS CLI User Guide. After confirming that the AWS CLI is available, run the following command.</p> <pre><code>aws cloudformation delete-stack --stack-name &lt;installation-stack-name&gt; --region &lt;aws-region&gt;\n</code></pre>"},{"location":"use-cases/","title":"Use cases","text":"<p>"},{"location":"architecture-overview/architecture-details/","title":"Architecture details","text":"<p>Diagram below is the brief view of internal workflow between offered extension and middleware, user will keep launching community WebUI onto standalone EC2/local server with our extension installed, while the ckpt merge, training and inference workload will be migrate onto AWS cloud through the RESTful API provided by middleware installed on user\u2019s AWS account. Note the middleware is per AWS account, means it could be installed separately as work node to communicate with WebUI as control node, user only need to input endpoint URL and API key per account to decide which specific AWS account will be used for successive jobs.</p> <p> Overall Workflow</p> <p>The middleware provides a RESTful API externally to comply with the OpenAPI specification to help WebUI extension to interact with AWS (Amazon SageMaker, S3, etc.). The main functions include request authentication, request distribution (such as SageMaker.jumpstart/model/predictor/estimator/tuner /utils, etc.), model training, model inference and other life cycle management work. The following figure shows the overall architecture of the middleware:</p> <p> Middleware Architecture</p> <ul> <li>Users in the WebUI console will use the assigned API token to trigger a request to API Gateway while being authenticated. (Note: AWS credentials are not required in AWS WebUI)</li> <li>API Gateway will route requests to Lambda with different functions according to URL prefixes to implement corresponding tasks (for example, model uploading, checkpoint merging), model training, and model inference. At the same time, the Lambda function records operational metadata into DynamoDB (eg, inferred parameters, model name) for subsequent query and correlation.</li> <li>During the training process, the Step Function will be called to orchestrate the training process, which includes using Amazon SageMaker for training and SNS for training status notification. During the inference process, the Lambda function will call Amazon SageMaker for asynchronous inference. Training data, models and checkpoints will be stored in S3 buckets separated by different prefixes.</li> </ul> <p>To keep container image of extension in sync with community, additional CI/CD pipeline (fig shown below) may needed to auto track community commits and pack &amp; build new container image, then user can easily launch latest extension without any manual operation.</p> <p> Image CI/CD Workflow</p>"},{"location":"architecture-overview/architecture/","title":"Architecture diagram","text":"<p>The overall architecture of the extension is composed of two components: the extension and the middleware. The extension is a WebUI extension that is installed on the community WebUI and responsible for providing a user interface for users to interact with the middleware. The middleware is a set of AWS resources that are deployed on the user's AWS account and responsible for providing RESTful APIs for the extension to interact with AWS resources. The whole solution provide a seamless experience for users to train and deploy models on AWS with following features:</p> <ul> <li>User Experience: Existing working flow is not changed, user can still use the community WebUI to train and deploy models with third-party extensions.</li> <li>Scalability: Existing workload including training and inference can be easily scaled and accelerated on Amazon SageMaker.</li> <li>Community: Provided extension is part of the community WebUI, which is open source and keeps evolving with the community.</li> </ul>"},{"location":"architecture-overview/design-considerations/","title":"Design considerations","text":"<p>This solution was designed with best practices from the AWS Well-Architected Framework which helps customers design and operate reliable, secure, efficient, and cost-effective workloads in the cloud. </p> <p>This section describes how the design principles and best practices of the Well-Architected Framework were applied when building this solution. </p>"},{"location":"deployment/deployment/","title":"Deployment step","text":"<p>Before you launch the solution, review the architecture, supported regions, and other considerations discussed in this guide. Follow the step-by-step instructions in this section to configure and deploy the solution into your account.</p> <p>Time to deploy: Approximately 25 minutes.</p>"},{"location":"deployment/deployment/#prerequisition","title":"Prerequisition","text":"<p>Users need to prepare a computer running linux system in advance.</p>"},{"location":"deployment/deployment/#deployment-overview","title":"Deployment overview","text":"<p>Use the following steps to deploy this solution on AWS. </p> <ul> <li>Step 1: Deploy Stable Diffusion WebUI. </li> <li>Step 2: Deploy the solution as a middleware.</li> <li>Step 3: Configure API url and API token.</li> </ul>"},{"location":"deployment/deployment/#deployment-steps","title":"Deployment steps","text":""},{"location":"deployment/deployment/#step-1-deploy-stable-diffusion-webui-linux","title":"Step 1: Deploy Stable Diffusion WebUI (Linux).","text":"<ol> <li> <p>Download the CloudFormation Template from link</p> </li> <li> <p>Sign in to the AWS Management Console and go to CloudFormation console</p> </li> <li> <p>On the Stacks page, choose Create stack, and then choose With new resources (standard).</p> </li> <li> <p>On the Specify template page, choose Template is ready, choose Upload a template file, and then browse for the template that is downloaded in step 1, and then choose Next.</p> </li> <li> <p>On the Specify stack details page, type a stack name in the Stack name box. Choose an EC2 instance key pair, then choose Next.</p> </li> <li> <p>On the Configure stack options page, choose Next.</p> </li> <li> <p>On the Review page, review the details of your stack, and choose Submit.</p> </li> <li> <p>Wait until the stack is created.</p> </li> <li> <p>Find the output value of the CloudFormation stack, and navigate to the WebUI by clicking the link in the WebUIURL value, note you need to wait extra 5 minutes to wait for the internal setup complete after the stack been created successfully.</p> </li> </ol>"},{"location":"deployment/deployment/#step-1-deploy-stable-diffusion-webui-windows","title":"Step 1: Deploy Stable Diffusion WebUI (Windows).","text":"<ol> <li>Start a Windows Server and log in via RDP.</li> <li>Refer to this link to install the NVIDIA driver.</li> <li>Visit the Python website, download Python, and install it. Remember to check \"Add Python to Path\" during installation.</li> <li>Visit the Git website, download Git, and install it.</li> <li>Open PowerShell and download the source code of this project by executing: <code>git clone https://github.com/awslabs/stable-diffusion-aws-extension</code>.</li> <li>Inside the source code directory, run <code>install.bat</code>.</li> <li>In the downloaded <code>stable-diffusion-webui</code> folder, run <code>webui-user.bat</code>.</li> </ol>"},{"location":"deployment/deployment/#step-2-deploy-the-solution-as-a-middleware","title":"Step 2: Deploy the solution as a middleware.","text":"<p>This automated AWS CloudFormation template deploys the solution in the AWS Cloud.</p> <ol> <li>Sign in to the AWS Management Console and use Launch solution in AWS Standard Regions to launch the AWS CloudFormation template.   </li> <li>The template will launch in the default region when you log into the console by default. To launch this solution in a different AWS Region, use the Region selector in the console navigation bar.</li> <li>On the Create stack page, verify that the correct template URL is shown in the Amazon S3 URL text box and choose Next.</li> <li> <p>On the Specify stack details page, assign a valid and account level unique name to your solution stack. Under Parameters, enter a valid bucket name under aigcbucketname for this solution to use, which is mainly for uploading dates and storing results. Enter a correct email address under email for future notice receiving. Enter a string of 20 characters that includes a combination of alphanumeric characters for sdextensionapikey, and it will be 09876543210987654321 by default. Select an instance type of Amazon EC2, which will mainly be used for operation including model creation, checkpoint merge, and etc. To select the tag for the ECR image corresponding to the solution, please refer to the ecrimagetag field (if no modification is needed, you can keep the default value). For specific tag explanations, please click on this link.Choose Next.</p> <p>Notice</p> <p>Please do not change ecrimagetag before consulting solution team.</p> </li> <li> <p>On the Configure stack options page, choose Next.</p> </li> <li>On the Review page, review and confirm the settings. Check the box acknowledging that the template will create AWS Identity and Access Management (IAM) resources. Choose Create stack to deploy the stack.</li> </ol> <p>You can view the status of the stack in the AWS CloudFormation Console in the Status column. You should receive a CREATE_COMPLETE status in approximately 15 minutes.</p> <p>Notice</p> <p>Please check the inbox of the email address you previously set up and click on the \"Confirm subscription\" hyperlink in the email with the subject \"AWS Notification - Subscription Confirmation\" to complete the subscription, and the message of 'Subscription confirmed!' appears.</p>"},{"location":"deployment/deployment/#step3-configure-api-url-and-api-token","title":"Step3: Configure API url and API token.","text":"<ol> <li> <p>Go to CloudFormation console.</p> </li> <li> <p>Select the root stack of the solution from the stack list, instead of a nested stack. Nested stacks in the list will be labeled as (NESTED) next to their names.</p> </li> <li> <p>Open the Outputs tab and locate the values corresponding to APIGatewayUrl and ApiGatewayUrlToken, and copy them.</p> </li> <li> <p>Open the Amazon SageMaker tab in the Stable Diffusion WebUI. Paste the URL obtained in step 3 into the API URL text box. Enter the token obtained in step 3 into the API Token field. Click Test Connection to receive a confirmation message of Successfully Connected.</p> </li> <li> <p>Click Update Setting to update the configuration file, so that you can receive the corresponding information next time.</p> </li> </ol>"},{"location":"deployment/ecr_image_param/","title":"How to modify the ECR image tag used in the solution","text":"<p>The current project uses the following three Public ECR images for training and inference: - public.ecr.aws/aws-gcr-solutions/stable-diffusion-aws-extension/aigc-webui-inference: TAG_NAME - public.ecr.aws/aws-gcr-solutions/stable-diffusion-aws-extension/aigc-webui-utils: TAG_NAME - public.ecr.aws/aws-gcr-solutions/stable-diffusion-aws-extension/aigc-webui-dreambooth-training: TAG_NAME</p> <p>The corresponding CDK deployment code can be found in: 1. infrastructure/src/common/dockerImages.ts</p> <pre><code>export const AIGC_WEBUI_INFERENCE: string = 'public.ecr.aws/aws-gcr-solutions/stable-diffusion-aws-extension/aigc-webui-inference:';\nexport const AIGC_WEBUI_UTILS: string = 'public.ecr.aws/aws-gcr-solutions/stable-diffusion-aws-extension/aigc-webui-utils:';\nexport const AIGC_WEBUI_DREAMBOOTH_TRAINING: string = 'public.ecr.aws/aws-gcr-solutions/stable-diffusion-aws-extension/aigc-webui-dreambooth-training:';\n</code></pre> <ol> <li>infrastructure/src/common/dockerImageTag.ts</li> </ol> <pre><code>export const ECR_IMAGE_TAG: string = 'dev';\n</code></pre> <p>TAG_NAME is defined by the CloudFormation deployment parameter <code>ecrimagetag</code>. By default, the tag value is dynamically generated during each compilation of the solution's CICD pipeline. For example, 'v1.0.0-46f9d43', where 'v1.0.0' represents the major version tag of the solution, and '46f9d43' is the commit ID of the project on GitHub.</p> <p>In most cases, users do not need to modify the ECR tag name. However, if users need to change the tag value, they can modify the default parameter value during the deployment of the solution's CloudFormation stack. Currently, we have two tag values available for users to choose from: 1. v1.0.0 2. v1.0.1-COMMITID</p> <p>```</p>"},{"location":"deployment/template/","title":"AWS CloudFormation template","text":"<p>To automate deployment, this solution uses the following AWS CloudFormation templates, which you can download before deployment:</p> <p>Extension for Stable Diffusion on AWS: Use this template to launch the solution and all associated components. The default configuration deploys Amazon API Gateway, AWS Lambda, Amazon S3, Amazon SageMaker and Amazon DynamoDB, but you can customize the template to meet your specific needs.</p>"},{"location":"developer-guide/api/","title":"Stable Diffusion AWS extension API v2023-07-05","text":""},{"location":"developer-guide/api/#stable-diffusion-train-and-deploy-api","title":"Stable Diffusion AWS extension API","text":""},{"location":"developer-guide/api/#overview","title":"Overview","text":"<p>This document describe all the api for Stable Diffusion AWS extension solution. This Solution contains two parts, one part is stable diffusion WebUI extension which is gradio based client to provide a user-friendly interface, another part is called middle-ware which is resources deploy on AWS cloud, the middleware provide several API interfaces to let stable diffusion aws extension client to interact services on AWS cloud like Sagemaker and S3 to do the model update/training and inference operations. </p> <p>In order to support users who do not use stable diffusion aws extension. We provide this document to list all the API interfaces to help user understand how to call API methods to do the training or inference.</p> <p>After user deployed solution middleware cloudformation, user can get the API URL and Token in the output part of the main stack. Please refer to this document</p> <p>Base URLs:</p> <ul> <li>https://API_Gateway_ID.execute-api.AWS_Account_Region.amazonaws.com/prod</li> </ul> <p>Authentication</p> <ul> <li>API Key (api_key)<ul> <li>Parameter Name: x-api-key, in: header. </li> </ul> </li> </ul>"},{"location":"developer-guide/api/#user-scenarios","title":"User Scenarios","text":""},{"location":"developer-guide/api/#1-deploy-a-new-endpoint","title":"1. Deploy a new Endpoint","text":"<p>Call /inference/deploy-sagemaker-endpoint to create a new sagemaker endpoint, you need to specify two parameters for creating, one is instance_type, candidate values are \"ml.g4dn.2xlarge\",\"ml.g4dn.4xlarge\",\"ml.g4dn.8xlarge\",\"ml.g4dn.12xlarge\", another is initial_instance_count, candidate values are 1|2|3|4.</p> <p>After calling /inference/deploy-sagemaker-endpoint, you need to call /inference/list-endpoint-deployment-jobs to list all the endpoint status. Normally it took about more than 10 minutes to make a new Sagemaker endpoint change to inService status. The Sagemaker endpoint can only be used for inference when it is inService status.</p> <p>If the endpoint is in failed status, you can call /inference/get-endpoint-deployment-job with parameter jobID, the response will show the reason why endpoint deployment is failed, normally it is caused by AWS account quota limitation.</p> sequence digram raw    title Create a Sagemaker Endpoint  Client-&gt;Middleware:Call /inference/deploy-sagemaker-endpoint Middleware-&gt;Middleware: Start a workflow to configure sagemaker endpoint \\n based on uer request configuration Client-&gt;Middleware:Call /inference/list-endpoint-deployment-jobs \\n to list all the endpoint creation job list Client-&gt;Middleware:Call /inference/get-endpoint-deployment-job \\n to check whether Sagemaker endpoint is in \\n 'inService' state."},{"location":"developer-guide/api/#2-upload-a-model","title":"2. Upload a model","text":""},{"location":"developer-guide/api/#3-train-a-model","title":"3. Train a model","text":""},{"location":"developer-guide/api/#4-do-inference","title":"4. Do Inference","text":"<p> After Sagemaker endpoint is in inService status, you can call /inference-api/inference to do the txt2image or image2image inference. You specify the endpoint name in \"sagemaker_endpoint\" parameter in the post body of the request. Other required parameters are located in /inference-api/inference.</p> <p>/inference-api/inference will return following json structure to client: <pre><code>{\n\"inference_id\": \"XXXXXXX\",\n\"status\": \"inprogress | failed\",\n\"endpoint_name\": \"NAME_OF_ENDPOINT\",\n\"output_path\": \"path_of_prediction_output\"\n}\n</code></pre> Client then can call /inference/get-inference-job using the inference_id as parameter to query the inference job status.  If the inference job has finished successfully(status is \"succeed\"), Client can use /inference/get-inference-job-image-output to get all inference result images, the images will be returned as S3 presigned url list so client can download. following is am example of get-inference-job-image-output result:</p> <pre><code>[\n\"https://stable-diffusion-aws-extension-aigcbucketa457cb49-1tlr2pqwkosg3.s3.amazonaws.com/out/1f9679f3-25b8-4c44-8345-0a845da30094/result/image_0.jpg\"\n]\n</code></pre> <p>Also Client can call /inference/get-inference-job-param-output to get all the inference parameters, the response of /inference/get-inference-job-param-output is an S3 presigned url contains the json format of the parameters, following is an response example:</p> <pre><code>[\n\"https://stable-diffusion-aws-extension-aigcbucketa457cb49-1tlr2pqwkosg3.s3.amazonaws.com/out/1f9679f3-25b8-4c44-8345-0a845da30094/result/1f9679f3-25b8-4c44-8345-0a845da30094_param.json\"\n]\n</code></pre> sequence digram raw  title Do Inference  Client-&gt;Middleware:Call **/inference-api/inference** Middleware-&gt;Middleware: Start a async inference job \\n on configure sagemaker endpoint \\n based on uer request configuration Middleware-&gt;Client: return inference_id  Client-&gt;Middleware:Call **/inference/get-inference-job** \\n to query the inference job status Middleware-&gt;Client: return inference_id and the job status(inprocess | succeed | failure)  abox over Client: If the inference job is succeed, \\n call **/inference/get-inference-job-image-output** and \\n **/inference/get-inference-job-param-output** to get the \\n inference result  Client-&gt;Middleware:Call **/inference/get-inference-job-image-output** \\n to get all inference result images.  Middleware-&gt;Client: return the inference result images in presigned url format  Client-&gt;Middleware:Call **/inference/get-inference-job-param-output** \\n to get inference parameters.  Middleware-&gt;Client: return the inference parameter in presigned url format"},{"location":"developer-guide/api/#api-list","title":"API List","text":"Index Http Method API Name Description 1 GET /inference/test-connection Test whether client can connect to api and check the API_TOKEN is correct 3 GET /inference/get-inference-job Retrieves details of a specific inference job. 4 GET /inference/get-inference-job-image-output Gets image output of a specific inference job. 5 GET /inference/get-inference-job-param-output Gets parameter output of a specific inference job. 6 POST /inference-api/inference Run sagemaker inference using default parameters 7 POST /inference/deploy-sagemaker-endpoint Deploys a SageMaker endpoint. 8 POST /inference/delete-sagemaker-endpoint Deletes a SageMaker endpoint. 9 GET /inference/list-endpoint-deployment-jobs Lists all endpoint deployment jobs. 10 GET /inference/get-endpoint-deployment-job Gets a specific endpoint deployment job. 11 GET /inference/generate-s3-presigned-url-for-uploading Generates an S3 presigned URL for uploading. 12 GET /inference/get-texual-inversion-list Gets the list of textual inversions. 13 GET /inference/get-lora-list Gets the list of LoRa. 14 GET /inference/get-hypernetwork-list Gets the list of hypernetworks. 15 GET /inference/get-controlnet-model-list Gets the list of ControlNet models. 16 POST /inference/run-model-merge Runs a model merge. 17 POST /model Creates a new model. 18 PUT /model Upload the model file 19 GET /models Lists all models. 20 GET /checkpoint Gets a checkpoint. 21 PUT /checkpoint Updates a checkpoint. 22 GET /checkpoints Lists all checkpoints. 23 POST /train-api/train Starts a training job. 24 PUT /train Updates a training job. 25 GET /trains Lists all training jobs. 26 POST /dataset Creates a new dataset. 27 PUT /dataset Updates a dataset. 28 GET /datasets Lists all datasets. 29 GET /{dataset_name}/data Gets data of a specific dataset."},{"location":"developer-guide/api/#inferencetest-connection","title":"/inference/test-connection","text":""},{"location":"developer-guide/api/#test-middleware-connection","title":"test middleware connection","text":""},{"location":"developer-guide/api/#code-samples","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/test-connection', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/test-connection',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/test-connection</code></p> <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"message\": \"Success\"\n}\n</code></pre>"},{"location":"developer-guide/api/#used-to-let-client-test-connection-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#inference-apiinference","title":"/inference-api/inference","text":"<p>Generate a new image from a text prompt.</p> <p></p>"},{"location":"developer-guide/api/#code-samples_1","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  \"Content-Type\": \"application/json\",\n  \"Accept\": \"application/json\",\n  'x-api-key': 'API_TOKEN_VALUE'\n}\nbody = {\n  \"task_type\": \"txt2img\",\n  \"models\": {\n    \"Stable-diffusion\": [\n      \"v1-5-pruned-emaonly.safetensors\"\n    ]\n  },\n  \"sagemaker_endpoint_name\": \"infer-endpoint-cb821ea\",\n  \"prompt\": \"a cute panda\",\n  \"denoising_strength\": 0.75\n}\n\nr = requests.post(\"https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference-api/inference\", headers = headers, json = body)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"task_type\": \"txt2img\",\n  \"models\": {\n    \"Stable-diffusion\": [\n      \"v1-5-pruned-emaonly.safetensors\"\n    ]\n  },\n  \"sagemaker_endpoint_name\": \"infer-endpoint-cb821ea\",\n  \"prompt\": \"a cute panda\",\n  \"denoising_strength\": 0.75\n}';\nconst headers = {\n\"Content-Type\":\"application/json\",\n\"Accept\":\"application/json\",\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch(\"https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference-api/inference\",\n{\nmethod: \"POST\",\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>POST /inference-api/inference</code></p> <p>Body parameter</p> <pre><code>{\n\"task_type\": \"txt2img\",\n\"models\": {\n\"Stable-diffusion\": [\n\"v1-5-pruned-emaonly.safetensors\"\n]\n},\n\"sagemaker_endpoint_name\": \"infer-endpoint-cb821ea\",\n\"prompt\": \"a cute panda\",\n\"denoising_strength\": 0.75\n}\n</code></pre>"},{"location":"developer-guide/api/#inference-api","title":"Parameters","text":"<p>Parameter example</p> <p>Below JSON shows the parameters with default value.  sagemaker_endpoint_name, task_type, prompt and Stable-diffusion are mandatory, other parameters are optional.</p> <pre><code>{\n\"sagemaker_endpoint_name\": \"infer-endpoint-ef3abcd\", \"task_type\": \"txt2img\",\n\"prompt\": \"\",\n\"models\": {\n\"Stable-diffusion\": [\n\"v1-5-pruned-emaonly.safetensors\"\n],\n\"Lora\": [\n\"raidenshogun1-000009.safetensors\"\n]\n},\n\"enable_hr\": false,\n\"denoising_strength\": null,\n\"firstphase_width\": 0,\n\"firstphase_height\": 0,\n\"hr_scale\": 2.0,\n\"hr_upscaler\": \"Latent\",\n\"hr_second_pass_steps\": 0,\n\"hr_resize_x\": 0,\n\"hr_resize_y\": 0,\n\"hr_sampler_name\": null,\n\"hr_prompt\": \"\",\n\"hr_negative_prompt\": \"\",\n\"prompt\": \"\",\n\"styles\": [],\n\"seed\": -1,\n\"subseed\": -1,\n\"subseed_strength\": 0.0,\n\"seed_resize_from_h\": 0,\n\"seed_resize_from_w\": 0,\n\"sampler_name\": \"Euler a\",\n\"batch_size\": 1,\n\"n_iter\": 1,\n\"steps\": 28,\n\"cfg_scale\": 7.0,\n\"width\": 512,\n\"height\": 512,\n\"restore_faces\": false,\n\"tiling\": false,\n\"do_not_save_samples\": false,\n\"do_not_save_grid\": false,\n\"negative_prompt\": \"\",\n\"eta\": null,\n\"s_min_uncond\": 0.0,\n\"s_churn\": 0.0,\n\"s_tmax\": 1.0,\n\"s_tmin\": 0.0,\n\"s_noise\": 1.0,\n\"override_settings\": {},\n\"override_settings_restore_afterwards\": true,\n\"script_args\": [],\n\"sampler_index\": \"Euler a\",\n\"script_name\": null,\n\"send_images\": true,\n\"save_images\": false,\n\"alwayson_scripts\": {\n\"controlnet\": {\n\"args\": [\n{\n\"enabled\": false,\n\"module\": \"none\",\n\"model\": \"None\",\n\"weight\": 1,\n\"image\": null,\n\"resize_mode\": \"Crop and Resize\",\n\"low_vram\": false,\n\"processor_res\": -1,\n\"threshold_a\": -1,\n\"threshold_b\": -1,\n\"guidance_start\": 0,\n\"guidance_end\": 1,\n\"pixel_perfect\": false,\n\"control_mode\": \"Balanced\",\n\"is_ui\": true,\n\"input_mode\": \"simple\",\n\"batch_images\": \"\",\n\"output_dir\": \"\",\n\"loopback\": false\n}\n]\n},\n\"extra options\": {\n\"args\": []\n}\n}\n}\n</code></pre> <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"inference_id\": \"XXXXXXX\",\n\"status\": \"inprogress | failed\",\n\"endpoint_name\": \"NAME_OF_ENDPOINT\",\n\"output_path\": \"path_of_prediction_output\"\n}\n</code></pre>"},{"location":"developer-guide/api/#inference-api","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#inferencedeploy-sagemaker-endpoint","title":"/inference/deploy-sagemaker-endpoint","text":""},{"location":"developer-guide/api/#code-samples_2","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\ninputBody = {\n    \"instance_type\": \"ml.g4dn.xlarge | ml.g4dn.2xlarge | ml.g4dn.4xlarge\",\n    \"initial_instance_count\": \"1|2|3|4\"\n}\n\nr = requests.post('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/deploy-sagemaker-endpoint', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"instance_type\": \"ml.g4dn.xlarge | ml.g4dn.2xlarge | ml.g4dn.4xlarge\",\n  \"initial_instance_count\": \"1|2|3|4\"\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/deploy-sagemaker-endpoint',\n{\nmethod: 'POST',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>POST /inference/deploy-sagemaker-endpoint</code></p> <p>Body parameter</p> <pre><code>{\n\"instance_type\": \"ml.g4dn.xlarge | ml.g4dn.2xlarge | ml.g4dn.4xlarge\",\n\"initial_instance_count\": \"1|2|3|4\"\n}\n</code></pre>"},{"location":"developer-guide/api/#deploy-sagemaker-endpoint-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>null\n</code></pre>"},{"location":"developer-guide/api/#deploy-sagemaker-endpoint-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#deploy-sagemaker-endpoint-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferencedelete-sagemaker-endpoint","title":"/inference/delete-sagemaker-endpoint","text":""},{"location":"developer-guide/api/#code-samples_3","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\ninputBody = {\n\"delete_endpoint_list\": [\n  \"infer-endpoint-XXXXXX\",\n  \"infer-endpoint-YYYYYY\"\n]\n}\n\nr = requests.post('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/delete-sagemaker-endpoint', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"delete_endpoint_list\": [\n    \"infer-endpoint-XXXXXX\",\n    \"infer-endpoint-YYYYYY\"\n  ]\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/delete-sagemaker-endpoint',\n{\nmethod: 'POST',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>POST /inference/delete-sagemaker-endpoint</code></p> <p>Body parameter</p> <pre><code>{\n\"delete_endpoint_list\": [\n\"infer-endpoint-XXXXXX\",\n\"infer-endpoint-YYYYYY\"\n]\n}\n</code></pre>"},{"location":"developer-guide/api/#delete-sagemaker-endpoint-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>null\n</code></pre>"},{"location":"developer-guide/api/#delete-sagemaker-endpoint-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#delete-sagemaker-endpoint-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferencelist-endpoint-deployment-jobs","title":"/inference/list-endpoint-deployment-jobs","text":""},{"location":"developer-guide/api/#code-samples_4","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/list-endpoint-deployment-jobs', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/list-endpoint-deployment-jobs',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/list-endpoint-deployment-jobs</code></p> <p>Example responses</p> <p>200 Response</p> <pre><code>[\n{\n\"EndpointDeploymentJobId\": \"e0f9ccfd-8d14-4e77-9e75-b340e1ef23c8\",\n\"startTime\": \"2023-07-04 08:00:35.171309\",\n\"endTime\": \"2023-07-04 08:00:37.158519\",\n\"error\": \"\",\n\"status\": \"failed\"\n},\n{\n\"EndpointDeploymentJobId\": \"1bd447d2-e561-4cb3-965d-2707b30aea81\",\n\"startTime\": \"2023-07-04 08:00:22.435828\",\n\"endTime\": \"2023-07-04 08:00:25.421777\",\n\"error\": \"\",\n\"status\": \"failed\"\n},\n{\n\"EndpointDeploymentJobId\": \"cb821ea9-e9d1-4bae-98f8-c20ecadf11e0\",\n\"startTime\": \"2023-07-04 08:00:47.736033\",\n\"endTime\": \"2023-07-04 08:12:55.148070\",\n\"endpoint_name\": \"infer-endpoint-cb821ea\",\n\"endpoint_status\": \"InService\",\n\"status\": \"success\"\n}\n]\n</code></pre>"},{"location":"developer-guide/api/#list-endpoint-deployment-jobs-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#list-endpoint-deployment-jobs-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferencelist-inference-jobs","title":"/inference/list-inference-jobs","text":""},{"location":"developer-guide/api/#code-samples_5","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/list-inference-jobs', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/list-inference-jobs',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/list-inference-jobs</code></p> <p>Example responses</p> <p>200 Response</p> <pre><code>[\n{\n\"inference_info_name\": \"/tmp/417d8bc5-f6d0-49c6-9669-c981beeb602a_param.json\",\n\"startTime\": \"2023-07-04 09:14:21.170303\",\n\"taskType\": \"txt2img\",\n\"completeTime\": \"2023-07-04-09-14-26\",\n\"InferenceJobId\": \"417d8bc5-f6d0-49c6-9669-c981beeb602a\",\n\"status\": \"succeed\",\n\"sagemakerRaw\": \"\",\n\"image_names\": [\n\"image_0.jpg\"\n]\n},\n{\n\"inference_info_name\": \"/tmp/1f9679f3-25b8-4c44-8345-0a845da30094_param.json\",\n\"startTime\": \"2023-07-05 06:38:45.752740\",\n\"taskType\": \"txt2img\",\n\"completeTime\": \"2023-07-05-06-38-49\",\n\"InferenceJobId\": \"1f9679f3-25b8-4c44-8345-0a845da30094\",\n\"status\": \"succeed\",\n\"sagemakerRaw\": \"{'awsRegion': 'us-west-2', 'eventTime': '2023-07-05T06:38:47.73Z', 'receivedTime': '2023-07-05T06:38:45.725Z', 'invocationStatus': 'Completed', 'requestParameters': {'accept': '*/*', 'endpointName': 'infer-endpoint-cb821ea', 'inputLocation': 's3://sagemaker-us-west-2-489670441870/async-endpoint-inputs/infer-endpoint-cb821ea-230705-0638/2023-07-05-06-38-45-445-81a1ec03-f000-4a20-9a60-032ab1558a9d'}, 'responseParameters': {'contentType': 'application/json', 'outputLocation': 's3://stable-diffusion-aws-extension-aigcbucketa457cb49-1tlr2pqwkosg3/sagemaker_output/211d2095-68bc-4404-a9e1-8a18a41f4dc7.out'}, 'inferenceId': '1f9679f3-25b8-4c44-8345-0a845da30094', 'eventVersion': '1.0', 'eventSource': 'aws:sagemaker', 'eventName': 'InferenceResult'}\",\n\"image_names\": [\n\"image_0.jpg\"\n]\n}\n]\n</code></pre>"},{"location":"developer-guide/api/#list-inference-jobs-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#list-inference-jobs-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferenceget-endpoint-deployment-job","title":"/inference/get-endpoint-deployment-job","text":""},{"location":"developer-guide/api/#code-samples_6","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-endpoint-deployment-job', params={\n  'jobID': 'string'\n}, headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-endpoint-deployment-job?jobID=string',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/get-endpoint-deployment-job</code></p>"},{"location":"developer-guide/api/#get-endpoint-deployment-job-parameters","title":"Parameters","text":"Name In Type Required Description jobID query string true none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"EndpointDeploymentJobId\": \"cb821ea9-e9d1-4bae-98f8-c20ecadf11e0\",\n\"startTime\": \"2023-07-04 08:00:47.736033\",\n\"endTime\": \"2023-07-04 08:12:55.148070\",\n\"endpoint_name\": \"infer-endpoint-cb821ea\",\n\"endpoint_status\": \"InService\",\n\"status\": \"success\"\n}\n</code></pre>"},{"location":"developer-guide/api/#get-endpoint-deployment-job-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline 422 Unprocessable Entity Validation Error HTTPValidationError"},{"location":"developer-guide/api/#get-endpoint-deployment-job-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferenceget-inference-job","title":"/inference/get-inference-job","text":""},{"location":"developer-guide/api/#code-samples_7","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-inference-job', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-inference-job',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/get-inference-job</code></p>"},{"location":"developer-guide/api/#get-inference-job-parameters","title":"Parameters","text":"Name In Type Required Description jobID query string false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"inference_info_name\": \"/tmp/1f9679f3-25b8-4c44-8345-0a845da30094_param.json\",\n\"startTime\": \"2023-07-05 06:38:45.752740\",\n\"taskType\": \"txt2img\",\n\"completeTime\": \"2023-07-05-06-38-49\",\n\"InferenceJobId\": \"1f9679f3-25b8-4c44-8345-0a845da30094\",\n\"status\": \"succeed\",\n\"sagemakerRaw\": \"{'awsRegion': 'us-west-2', 'eventTime': '2023-07-05T06:38:47.73Z', 'receivedTime': '2023-07-05T06:38:45.725Z', 'invocationStatus': 'Completed', 'requestParameters': {'accept': '*/*', 'endpointName': 'infer-endpoint-cb821ea', 'inputLocation': 's3://sagemaker-us-west-2-489670441870/async-endpoint-inputs/infer-endpoint-cb821ea-230705-0638/2023-07-05-06-38-45-445-81a1ec03-f000-4a20-9a60-032ab1558a9d'}, 'responseParameters': {'contentType': 'application/json', 'outputLocation': 's3://stable-diffusion-aws-extension-aigcbucketa457cb49-1tlr2pqwkosg3/sagemaker_output/211d2095-68bc-4404-a9e1-8a18a41f4dc7.out'}, 'inferenceId': '1f9679f3-25b8-4c44-8345-0a845da30094', 'eventVersion': '1.0', 'eventSource': 'aws:sagemaker', 'eventName': 'InferenceResult'}\",\n\"image_names\": [\n\"image_0.jpg\"\n]\n}\n</code></pre>"},{"location":"developer-guide/api/#get-inference-job-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline 422 Unprocessable Entity Validation Error HTTPValidationError"},{"location":"developer-guide/api/#get-inference-job-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferenceget-inference-job-image-output","title":"/inference/get-inference-job-image-output","text":""},{"location":"developer-guide/api/#code-samples_8","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-inference-job-image-output', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-inference-job-image-output',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/get-inference-job-image-output</code></p>"},{"location":"developer-guide/api/#get-inference-job-image-output-parameters","title":"Parameters","text":"Name In Type Required Description jobID query string false none <p>Example responses</p> <p>200 Response</p> <pre><code>[\n\"https://stable-diffusion-aws-extension-aigcbucketa457cb49-1tlr2pqwkosg3.s3.amazonaws.com/out/1f9679f3-25b8-4c44-8345-0a845da30094/result/image_0.jpg\"\n]\n</code></pre>"},{"location":"developer-guide/api/#get-inference-job-image-output-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline 422 Unprocessable Entity Validation Error HTTPValidationError"},{"location":"developer-guide/api/#get-inference-job-image-output-responseschema","title":"Response Schema","text":"<p>Status Code 200</p> <p>Response Get Inference Job Image Output Inference Get Inference Job Image Output Get</p> Name Type Required Restrictions Description Response Get Inference Job Image Output Inference Get Inference Job Image Output Get [string] false none none  This operation does not require authentication  <p></p>"},{"location":"developer-guide/api/#inferenceget-inference-job-param-output","title":"/inference/get-inference-job-param-output","text":""},{"location":"developer-guide/api/#code-samples_9","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-inference-job-param-output', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-inference-job-param-output',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/get-inference-job-param-output</code></p>"},{"location":"developer-guide/api/#get-inference-job-param-output-parameters","title":"Parameters","text":"Name In Type Required Description jobID query string false none <p>Example responses</p> <p>200 Response</p> <pre><code>[\n\"https://stable-diffusion-aws-extension-aigcbucketa457cb49-1tlr2pqwkosg3.s3.amazonaws.com/out/1f9679f3-25b8-4c44-8345-0a845da30094/result/1f9679f3-25b8-4c44-8345-0a845da30094_param.json\"\n]\n</code></pre>"},{"location":"developer-guide/api/#get-inference-job-param-output-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline 422 Unprocessable Entity Validation Error HTTPValidationError"},{"location":"developer-guide/api/#inferencegenerate-s3-presigned-url-for-uploading","title":"/inference/generate-s3-presigned-url-for-uploading","text":""},{"location":"developer-guide/api/#code-samples_10","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/generate-s3-presigned-url-for-uploading', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/generate-s3-presigned-url-for-uploading',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/generate-s3-presigned-url-for-uploading</code></p>"},{"location":"developer-guide/api/#generate-s3-presigned-url-for-uploading-parameters","title":"Parameters","text":"Name In Type Required Description s3_bucket_name query string false none key query string false none <p>Example responses</p> <p>200 Response</p> <pre><code>\"https://stable-diffusion-aws-extension-aigcbucketa457cb49-1tlr2pqwkosg3.s3.amazonaws.com/config/aigc.json?XXX\"\n</code></pre>"},{"location":"developer-guide/api/#generate-s3-presigned-url-for-uploading-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response string 422 Unprocessable Entity Validation Error HTTPValidationError  This operation does not require authentication"},{"location":"developer-guide/api/#inferenceget-texual-inversion-list","title":"/inference/get-texual-inversion-list","text":""},{"location":"developer-guide/api/#code-samples_11","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-texual-inversion-list', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-texual-inversion-list',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/get-texual-inversion-list</code></p> <p>Example responses</p> <p>200 Response</p> <pre><code>null\n</code></pre>"},{"location":"developer-guide/api/#get-textual-inversion-list-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#get-textual-inversion-list-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferenceget-lora-list","title":"/inference/get-lora-list","text":""},{"location":"developer-guide/api/#code-samples_12","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-lora-list', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-lora-list',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/get-lora-list</code></p> <p>Example responses</p> <p>200 Response</p> <pre><code>null\n</code></pre>"},{"location":"developer-guide/api/#get-lora-list-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#get-lora-list-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferenceget-hypernetwork-list","title":"/inference/get-hypernetwork-list","text":""},{"location":"developer-guide/api/#code-samples_13","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-hypernetwork-list', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-hypernetwork-list',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/get-hypernetwork-list</code></p> <p>Example responses</p> <p>200 Response</p> <pre><code>null\n</code></pre>"},{"location":"developer-guide/api/#get-hypernetwork-list-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#get-hypernetwork-list-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferenceget-controlnet-model-list","title":"/inference/get-controlnet-model-list","text":""},{"location":"developer-guide/api/#code-samples_14","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-controlnet-model-list', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/get-controlnet-model-list',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /inference/get-controlnet-model-list</code></p> <p>Example responses</p> <p>200 Response</p> <pre><code>null\n</code></pre>"},{"location":"developer-guide/api/#get-controlnet-model-list-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#get-controlnet-model-list-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#inferencerun-model-merge","title":"/inference/run-model-merge","text":""},{"location":"developer-guide/api/#code-samples_15","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.post('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/run-model-merge', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key': 'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/inference/run-model-merge',\n{\nmethod: 'POST',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>POST /inference/run-model-merge</code></p> <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"primary_model_name\": \"primary_model_name,\",\n\"secondary_model_name\": \"secondary_model_name,\",\n\"tertiary_model_name\": \"teritary_model_name\"\n}\n</code></pre>"},{"location":"developer-guide/api/#run-model-merge-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful Response Inline"},{"location":"developer-guide/api/#run-model-merge-responseschema","title":"Response Schema","text":"This operation does not require authentication"},{"location":"developer-guide/api/#stable-diffusion-train-and-deploy-api-default","title":"default","text":""},{"location":"developer-guide/api/#modelpost","title":"/model(POST)","text":""},{"location":"developer-guide/api/#code-samples_16","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.post('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/model', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"model_type\": \"Stable-diffusion\",\n  \"name\": \"testmodelcreation01\",\n  \"filenames\": [\n    {\n      \"filename\": \"v1-5-pruned-emaonly.safetensors.tar\",\n      \"parts_number\": 5\n    }\n  ],\n  \"params\": {\n    \"create_model_params\": {\n      \"new_model_name\": \"testmodelcreation01\",\n      \"ckpt_path\": \"v1-5-pruned-emaonly.safetensors\",\n      \"from_hub\": false,\n      \"new_model_url\": \"\",\n      \"new_model_token\": \"\",\n      \"extract_ema\": false,\n      \"train_unfrozen\": false,\n      \"is_512\": true\n    }\n  }\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/model',\n{\nmethod: 'POST',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>POST /model</code></p> <p>Body parameter</p> <pre><code>{\n\"model_type\": \"Stable-diffusion\",\n\"name\": \"testmodelcreation01\",\n\"filenames\": [\n{\n\"filename\": \"v1-5-pruned-emaonly.safetensors.tar\",\n\"parts_number\": 5\n}\n],\n\"params\": {\n\"create_model_params\": {\n\"new_model_name\": \"testmodelcreation01\",\n\"ckpt_path\": \"v1-5-pruned-emaonly.safetensors\",\n\"from_hub\": false,\n\"new_model_url\": \"\",\n\"new_model_token\": \"\",\n\"extract_ema\": false,\n\"train_unfrozen\": false,\n\"is_512\": true\n}\n}\n}\n</code></pre>"},{"location":"developer-guide/api/#create-model-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"job\": {\n\"id\": \"id\",\n\"status\": \"Initialed\",\n\"s3_base\": \"s3://S3_Location\",\n\"model_type\": \"Stable-diffusion\",\n\"params\": {},\n\"s3PresignUrl\": [\n{\n\"upload_id\": \"id\",\n\"bucket\": \"bucket name\",\n\"key\": \"object key\"\n}\n]\n}\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#create-model-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#create-model-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#modelput","title":"/model(PUT)","text":""},{"location":"developer-guide/api/#code-samples_17","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\ninputBody = {\n\"model_id\": \"c9f59ee7-0672-4fd1-8a45-8a494de8a48d\",\n\"status\": \"Creating\",\n\"multi_parts_tags\": {\n  \"v1-5-pruned-emaonly.safetensors.tar\": [\n    {\n      \"ETag\": \"cc95c41fa28463c8e9b88d67805f24e0\",\n      \"PartNumber\": 1\n    },\n    {\n      \"ETag\": \"e4378bd84b0497559c55be8373cb79d0\",\n      \"PartNumber\": 2\n    },\n    {\n      \"ETag\": \"815b68042f6ac5e60b9cff5c697ffea6\",\n      \"PartNumber\": 3\n    },\n    {\n      \"ETag\": \"2c6cfbd9bfbafd5664cdc8b3ba07df6d\",\n      \"PartNumber\": 4\n    },\n    {\n      \"ETag\": \"e613d37e5065b0cd63f1cad216423141\",\n      \"PartNumber\": 5\n    }\n  ]\n}\n}\n\nr = requests.put('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/model', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"model_id\": \"c9f59ee7-0672-4fd1-8a45-8a494de8a48d\",\n  \"status\": \"Creating\",\n  \"multi_parts_tags\": {\n    \"v1-5-pruned-emaonly.safetensors.tar\": [\n      {\n        \"ETag\": \"cc95c41fa28463c8e9b88d67805f24e0\",\n        \"PartNumber\": 1\n      },\n      {\n        \"ETag\": \"e4378bd84b0497559c55be8373cb79d0\",\n        \"PartNumber\": 2\n      },\n      {\n        \"ETag\": \"815b68042f6ac5e60b9cff5c697ffea6\",\n        \"PartNumber\": 3\n      },\n      {\n        \"ETag\": \"2c6cfbd9bfbafd5664cdc8b3ba07df6d\",\n        \"PartNumber\": 4\n      },\n      {\n        \"ETag\": \"e613d37e5065b0cd63f1cad216423141\",\n        \"PartNumber\": 5\n      }\n    ]\n  }\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/model',\n{\nmethod: 'PUT',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>PUT /model</code></p> <p>Body parameter</p> <pre><code>{\n\"model_id\": \"c9f59ee7-0672-4fd1-8a45-8a494de8a48d\",\n\"status\": \"Creating\",\n\"multi_parts_tags\": {\n\"v1-5-pruned-emaonly.safetensors.tar\": [\n{\n\"ETag\": \"cc95c41fa28463c8e9b88d67805f24e0\",\n\"PartNumber\": 1\n},\n{\n\"ETag\": \"e4378bd84b0497559c55be8373cb79d0\",\n\"PartNumber\": 2\n},\n{\n\"ETag\": \"815b68042f6ac5e60b9cff5c697ffea6\",\n\"PartNumber\": 3\n},\n{\n\"ETag\": \"2c6cfbd9bfbafd5664cdc8b3ba07df6d\",\n\"PartNumber\": 4\n},\n{\n\"ETag\": \"e613d37e5065b0cd63f1cad216423141\",\n\"PartNumber\": 5\n}\n]\n}\n}\n</code></pre>"},{"location":"developer-guide/api/#update-model-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"job\": {\n\"output_path\": \"s3://S3_Location\",\n\"id\": \"job.id\",\n\"endpointName\": \"endpoint_name\",\n\"jobStatus\": \"Created\",\n\"jobType\": \"Stable-diffusion\"\n}\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#update-model-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#update-model-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#modelsget","title":"/models(GET)","text":""},{"location":"developer-guide/api/#code-samples_18","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/models', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/models',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /models</code></p>"},{"location":"developer-guide/api/#list-models-parameters","title":"Parameters","text":"Name In Type Required Description types query array[string] false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"models\": {\n\"id\": \"id\",\n\"model_name\": \"name\",\n\"created\": 12341234,\n\"params\": {},\n\"status\": \"Initialed\",\n\"output_s3_location\": \"s3://S3_LOCATION/\"\n}\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#list-models-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#list-models-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#checkpoint","title":"/checkpoint","text":""},{"location":"developer-guide/api/#code-samples_19","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\ninputBody = {\n\"checkpoint_type\": \"Stable-diffusion\",\n\"filenames\": [\n  {\n    \"filename\": \"v1-5-pruned-emaonly.safetensors\",\n    \"parts_number\": 5\n  }\n],\n\"params\": {\n  \"new_model_name\": \"test_api\",\n  \"number\": 1,\n  \"string\": \"abc\"\n}\n}\n\nr = requests.post('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/checkpoint', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"checkpoint_type\": \"Stable-diffusion\",\n  \"filenames\": [\n    {\n      \"filename\": \"v1-5-pruned-emaonly.safetensors\",\n      \"parts_number\": 5\n    }\n  ],\n  \"params\": {\n    \"new_model_name\": \"test_api\",\n    \"number\": 1,\n    \"string\": \"abc\"\n  }\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/checkpoint',\n{\nmethod: 'POST',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>POST /checkpoint</code></p> <p>Body parameter</p> <pre><code>{\n\"checkpoint_type\": \"Stable-diffusion\",\n\"filenames\": [\n{\n\"filename\": \"v1-5-pruned-emaonly.safetensors\",\n\"parts_number\": 5\n}\n],\n\"params\": {\n\"new_model_name\": \"test_api\",\n\"number\": 1,\n\"string\": \"abc\"\n}\n}\n</code></pre>"},{"location":"developer-guide/api/#create-checkpoint-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"checkpoint\": {\n\"id\": \"id\",\n\"type\": \"Stable-diffusion\",\n\"s3_location\": \"s3://S3_Location\",\n\"status\": \"Initialed\",\n\"params\": {}\n},\n\"s3PresignUrl\": [\n{\n\"upload_id\": \"id,\",\n\"bucket\": \"bucket name,\",\n\"key\": \"key,\"\n}\n]\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#create-checkpoint-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#create-checkpoint-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#checkpointput","title":"/checkpoint(put)","text":""},{"location":"developer-guide/api/#code-samples_20","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\ninputBody = {\n\"checkpoint_id\": \"906a5a1f-6833-45aa-8a10-fb0e983e0eae\",\n\"status\": \"Active\",\n\"multi_parts_tags\": {\n  \"v1-5-pruned-emaonly.safetensors.tar\": [\n    {\n      \"ETag\": \"cc95c41fa28463c8e9b88d67805f24e0\",\n      \"PartNumber\": 1\n    },\n    {\n      \"ETag\": \"e4378bd84b0497559c55be8373cb79d0\",\n      \"PartNumber\": 2\n    },\n    {\n      \"ETag\": \"815b68042f6ac5e60b9cff5c697ffea6\",\n      \"PartNumber\": 3\n    },\n    {\n      \"ETag\": \"2c6cfbd9bfbafd5664cdc8b3ba07df6d\",\n      \"PartNumber\": 4\n    },\n    {\n      \"ETag\": \"e613d37e5065b0cd63f1cad216423141\",\n      \"PartNumber\": 5\n    }\n  ]\n}\n}\n\nr = requests.put('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/checkpoint', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"checkpoint_id\": \"906a5a1f-6833-45aa-8a10-fb0e983e0eae\",\n  \"status\": \"Active\",\n  \"multi_parts_tags\": {\n    \"v1-5-pruned-emaonly.safetensors.tar\": [\n      {\n        \"ETag\": \"cc95c41fa28463c8e9b88d67805f24e0\",\n        \"PartNumber\": 1\n      },\n      {\n        \"ETag\": \"e4378bd84b0497559c55be8373cb79d0\",\n        \"PartNumber\": 2\n      },\n      {\n        \"ETag\": \"815b68042f6ac5e60b9cff5c697ffea6\",\n        \"PartNumber\": 3\n      },\n      {\n        \"ETag\": \"2c6cfbd9bfbafd5664cdc8b3ba07df6d\",\n        \"PartNumber\": 4\n      },\n      {\n        \"ETag\": \"e613d37e5065b0cd63f1cad216423141\",\n        \"PartNumber\": 5\n      }\n    ]\n  }\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/checkpoint',\n{\nmethod: 'PUT',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>PUT /checkpoint</code></p> <p>Body parameter</p> <pre><code>{\n\"checkpoint_id\": \"906a5a1f-6833-45aa-8a10-fb0e983e0eae\",\n\"status\": \"Active\",\n\"multi_parts_tags\": {\n\"v1-5-pruned-emaonly.safetensors.tar\": [\n{\n\"ETag\": \"cc95c41fa28463c8e9b88d67805f24e0\",\n\"PartNumber\": 1\n},\n{\n\"ETag\": \"e4378bd84b0497559c55be8373cb79d0\",\n\"PartNumber\": 2\n},\n{\n\"ETag\": \"815b68042f6ac5e60b9cff5c697ffea6\",\n\"PartNumber\": 3\n},\n{\n\"ETag\": \"2c6cfbd9bfbafd5664cdc8b3ba07df6d\",\n\"PartNumber\": 4\n},\n{\n\"ETag\": \"e613d37e5065b0cd63f1cad216423141\",\n\"PartNumber\": 5\n}\n]\n}\n}\n</code></pre>"},{"location":"developer-guide/api/#update-checkpoints-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"checkpoint\": {\n\"id\": \"id\",\n\"type\": \"Stable-diffusion\",\n\"s3_location\": \"s3://S3_Location\",\n\"status\": \"Active\",\n\"params\": {}\n}\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#update-checkpoints-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#update-checkpoints-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#checkpoints","title":"/checkpoints","text":""},{"location":"developer-guide/api/#code-samples_21","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/checkpoints', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/checkpoints',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /checkpoints</code></p>"},{"location":"developer-guide/api/#list-checkpoints-parameters","title":"Parameters","text":"Name In Type Required Description status query array[string] false none types query array[string] false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"checkpoints\": [\n{\n\"id\": \"id\",\n\"s3Location\": \"s3://S3_Location\",\n\"type\": \"Stable-diffusion\",\n\"status\": \"Active\",\n\"name\": [\n\"object_1\",\n\"object_2\"\n],\n\"created\": 12341234\n}\n]\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#list-checkpoints-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#list-checkpoints-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#train-apitrainpost","title":"/train-api/train(POST)","text":""},{"location":"developer-guide/api/#code-samples_22","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nconst inputBody = {\n    \"train_type\": \"Stable-diffusion\",\n    \"model_id\": \"7ec754d6-1f68-46ea-9cfe-efeeed0c986c\",\n    \"params\": {\n        \"training_params\": {\n            \"data_tar_list\": [\n                \"s3://&lt;your_s3_bucket&gt;/dataset/&lt;your_dataset_name&gt;\"\n            ],\n            \"class_data_tar_list\": [\n                \"\"\n            ],\n            \"training_instance_type\": \"ml.g5.2xlarge\"\n        },\n        \"config_params\": {\n            \"concepts_list\": [{\n                \"class_data_dir\": \"\",\n                \"class_guidance_scale\": 7.5,\n                \"class_infer_steps\": 40,\n                \"class_negative_prompt\": \"\",\n                \"class_prompt\": \"\",\n                \"class_token\": \"\",\n                \"instance_prompt\": \"hanportraittest123\",\n                \"num_class_images_per\": 0,\n                \"instance_data_dir\": \"s3://&lt;your_s3_bucket&gt;/dataset/&lt;your_dataset_name&gt;\",\n                \"instance_token\": \"\",\n                \"is_valid\": true,\n                \"n_save_sample\": 1,\n                \"sample_seed\": -1,\n                \"save_guidance_scale\": 7.5,\n                \"save_infer_steps\": 20,\n                \"save_sample_negative_prompt\": \"\",\n                \"save_sample_prompt\": \"\",\n                \"save_sample_template\": \"\"\n            }],\n            \"model_dir\": \"models/dreambooth/&lt;your_model_name&gt;\",\n            \"model_name\": \"your_model_name\",\n            \"pretrained_model_name_or_path\": \"models/dreambooth/&lt;your_model_name&gt;/working\",\n            \"num_train_epochs\": 100,\n            \"use_lora\": true,\n            \"revision\": \"\"\n        }\n    }\n}\n\n\nr = requests.post('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/train-api/train', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code\uff1a</p> <pre><code>const inputBody = '{\n    \"train_type\": \"Stable-diffusion\",\n    \"model_id\": \"7ec754d6-1f68-46ea-9cfe-efeeed0c986c\",\n    \"params\": {\n        \"training_params\": {\n            \"data_tar_list\": [\n                \"s3://&lt;your_s3_bucket&gt;/dataset/&lt;your_dataset_name&gt;\"\n            ],\n            \"class_data_tar_list\": [\n                \"\"\n            ],\n            \"training_instance_type\": \"ml.g5.2xlarge\"\n        },\n        \"config_params\": {\n            \"concepts_list\": [{\n                \"class_data_dir\": \"\",\n                \"class_guidance_scale\": 7.5,\n                \"class_infer_steps\": 40,\n                \"class_negative_prompt\": \"\",\n                \"class_prompt\": \"\",\n                \"class_token\": \"\",\n                \"instance_prompt\": \"hanportraittest123\",\n                \"num_class_images_per\": 0,\n                \"instance_data_dir\": \"s3://&lt;your_s3_bucket&gt;/dataset/&lt;your_dataset_name&gt;\",\n                \"instance_token\": \"\",\n                \"is_valid\": true,\n                \"n_save_sample\": 1,\n                \"sample_seed\": -1,\n                \"save_guidance_scale\": 7.5,\n                \"save_infer_steps\": 20,\n                \"save_sample_negative_prompt\": \"\",\n                \"save_sample_prompt\": \"\",\n                \"save_sample_template\": \"\"\n            }],\n            \"model_dir\": \"models/dreambooth/&lt;your_model_name&gt;\",\n            \"model_name\": \"your_model_name\",\n            \"pretrained_model_name_or_path\": \"models/dreambooth/&lt;your_model_name&gt;/working\",\n            \"num_train_epochs\": 100,\n            \"use_lora\": true,\n            \"revision\": \"\"\n        }\n    }\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/train-api/train',\n{\nmethod: 'POST',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>POST /train-api/train</code></p> <p>Body parameter</p> <pre><code>{\n\"train_type\": \"Stable-diffusion\",\n\"model_id\": \"7ec754d6-1f68-46ea-9cfe-efeeed0c986c\",\n\"params\": {\n\"training_params\": {\n\"data_tar_list\": [\n\"s3://&lt;your_s3_bucket&gt;/dataset/&lt;your_dataset_name&gt;\"\n],\n\"class_data_tar_list\": [\n\"\"\n],\n\"training_instance_type\": \"ml.g5.2xlarge\"\n},\n\"config_params\": {\n\"concepts_list\": [{\n\"class_data_dir\": \"\",\n\"class_guidance_scale\": 7.5,\n\"class_infer_steps\": 40,\n\"class_negative_prompt\": \"\",\n\"class_prompt\": \"\",\n\"class_token\": \"\",\n\"instance_prompt\": \"hanportraittest123\",\n\"num_class_images_per\": 0,\n\"instance_data_dir\": \"s3://&lt;your_s3_bucket&gt;/dataset/&lt;your_dataset_name&gt;\",\n\"instance_token\": \"\",\n\"is_valid\": true,\n\"n_save_sample\": 1,\n\"sample_seed\": -1,\n\"save_guidance_scale\": 7.5,\n\"save_infer_steps\": 20,\n\"save_sample_negative_prompt\": \"\",\n\"save_sample_prompt\": \"\",\n\"save_sample_template\": \"\"\n}],\n\"model_dir\": \"models/dreambooth/&lt;your_model_name&gt;\",\n\"model_name\": \"your_model_name\",\n\"pretrained_model_name_or_path\": \"models/dreambooth/&lt;your_model_name&gt;/working\",\n\"num_train_epochs\": 100,\n\"use_lora\": true,\n\"revision\": \"\"\n}\n}\n}\n</code></pre>"},{"location":"developer-guide/api/#create-train-job-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"job\": {\n\"id\": \"81f00711-7cc3-4cac-90f3-13934f29524a\",\n\"status\": \"Initial\",\n\"trainType\": \"Stable-diffusion\",\n\"params\": {\n\"training_params\": {\n...\n},\n\"config_params\": {\n...\n}\n},\n\"input_location\": \"s3://&lt;your_s3_bucket&gt;/train/&lt;your_model_name&gt;/81f00711-7cc3-4cac-90f3-13934f29524a/input\"\n},\n\"s3PresignUrl\": null\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#create-train-job-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#create-train-job-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#trainput","title":"/train(PUT)","text":""},{"location":"developer-guide/api/#code-samples_23","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\ninputBody = {\n\"train_job_id\": \"b5183dd3-0279-46ff-b64e-6cd687c0fe71\",\n\"status\": \"Training\"\n}\n\nr = requests.put('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/train', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"train_job_id\": \"b5183dd3-0279-46ff-b64e-6cd687c0fe71\",\n  \"status\": \"Training\"\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/train',\n{\nmethod: 'PUT',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>PUT /train</code></p> <p>Body parameter</p> <pre><code>{\n\"train_job_id\": \"b5183dd3-0279-46ff-b64e-6cd687c0fe71\",\n\"status\": \"Training\"\n}\n</code></pre>"},{"location":"developer-guide/api/#update-train-job-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"job\": {\n\"id\": \"id\",\n\"status\": \"Training\",\n\"created\": 12341234,\n\"trainType\": \"Stable-diffusion\",\n\"params\": {},\n\"input_location\": \"s3://S3_Location\"\n}\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#update-train-job-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#update-train-job-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#trainsget","title":"/trains(GET)","text":""},{"location":"developer-guide/api/#code-samples_24","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/trains', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/trains',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /trains</code></p>"},{"location":"developer-guide/api/#list-train-jobs-parameters","title":"Parameters","text":"Name In Type Required Description types query array[string] false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": \"200,\",\n\"trainJobs\": [\n{\n\"id\": \"id\",\n\"modelName\": \"model_name\",\n\"status\": \"Complete\",\n\"trainType\": \"Stable-diffusion\",\n\"created\": 1234124,\n\"sagemakerTrainName\": \"sagemaker_train_name\"\n}\n]\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#list-train-jobs-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#list-train-jobs-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#datasetpost","title":"/dataset(POST)","text":""},{"location":"developer-guide/api/#code-samples_25","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nconst inputBody = {\n\"dataset_name\": \"test_dataset\",\n\"content\": [\n  {\n    \"filename\": \"/path/to/a/file.png\",\n    \"name\": \"another_name\",\n    \"type\": \"png\"\n  }\n],\n\"params\": {}\n}\n\nr = requests.post('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/dataset', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"dataset_name\": \"test_dataset\",\n  \"content\": [\n    {\n      \"filename\": \"/path/to/a/file.png\",\n      \"name\": \"another_name\",\n      \"type\": \"png\"\n    }\n  ],\n  \"params\": {}\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/dataset',\n{\nmethod: 'POST',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>POST /dataset</code></p> <p>Body parameter</p> <pre><code>{\n\"dataset_name\": \"test_dataset\",\n\"content\": [\n{\n\"filename\": \"/path/to/a/file.png\",\n\"name\": \"another_name\",\n\"type\": \"png\"\n}\n],\n\"params\": {}\n}\n</code></pre>"},{"location":"developer-guide/api/#create-dataset-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"datasetName\": \"dataset_name\",\n\"s3PresignUrl\": [\n{\n\"filename\": \"s3://S3_Location\"\n}\n]\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#create-dataset-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#create-dataset-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#datasetput","title":"/dataset(PUT)","text":""},{"location":"developer-guide/api/#code-samples_26","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Content-Type': 'application/json',\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\ninputBody = {\n\"dataset_name\": \"test_dataset\",\n\"status\": \"Enabled\"\n}\n\nr = requests.put('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/dataset', headers = headers, json = inputBody)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const inputBody = '{\n  \"dataset_name\": \"test_dataset\",\n  \"status\": \"Enabled\"\n}';\nconst headers = {\n'Content-Type':'application/json',\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/dataset',\n{\nmethod: 'PUT',\nbody: inputBody,\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>PUT /dataset</code></p> <p>Body parameter</p> <pre><code>{\n\"dataset_name\": \"test_dataset\",\n\"status\": \"Enabled\"\n}\n</code></pre>"},{"location":"developer-guide/api/#update-dataset-parameters","title":"Parameters","text":"Name In Type Required Description body body object false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"datasetName\": \"dataset_name\",\n\"status\": \"Enabled\"\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#update-dataset-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#update-dataset-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#datasetsget","title":"/datasets(GET)","text":""},{"location":"developer-guide/api/#code-samples_27","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/datasets', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/prod/datasets',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /prod/datasets</code></p>"},{"location":"developer-guide/api/#list-datasets-by-dataset-status-parameters","title":"Parameters","text":"Name In Type Required Description dataset_status query array[string] false none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"datasets\": [\n{\n\"datasetName\": \"dataset_name\",\n\"s3\": \"s3://S3_Location\",\n\"status\": \"Enabled\",\n\"timestamp\": 1234124\n}\n]\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#list-datasets-by-dataset-status-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#list-datasets-by-dataset-status-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/api/#dataset_namedata","title":"/{dataset_name}/data","text":""},{"location":"developer-guide/api/#code-samples_28","title":"Code samples :","text":"<p>Python example code:</p> <pre><code>import requests\nheaders = {\n  'Accept': 'application/json',\n  'x-api-key': 'API_TOKEN_VALUE'\n}\n\nr = requests.get('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/{dataset_name}/data', headers = headers)\n\nprint(r.json())\n</code></pre> <p>Javascript example code:</p> <pre><code>const headers = {\n'Accept':'application/json',\n'x-api-key':'API_TOKEN_VALUE'\n};\n\nfetch('https://&lt;Your API Gateway ID&gt;.execute-api.&lt;Your AWS Account Region&gt;.amazonaws.com/{basePath}/{dataset_name}/data',\n{\nmethod: 'GET',\n\nheaders: headers\n})\n.then(function(res) {\nreturn res.json();\n}).then(function(body) {\nconsole.log(body);\n});\n</code></pre> <p><code>GET /{dataset_name}/data</code></p>"},{"location":"developer-guide/api/#list-dataset-items-by-dataset-name-parameters","title":"Parameters","text":"Name In Type Required Description dataset_name path string true none <p>Example responses</p> <p>200 Response</p> <pre><code>{\n\"statusCode\": 200,\n\"dataset_name\": \"dataset_name\",\n\"data\": [\n{\n\"key\": \"key\",\n\"name\": \"file name\",\n\"type\": \"image\",\n\"preview_url\": \"https://presigned_s3_url\",\n\"dataStatus\": \"Enabled\"\n}\n]\n}\n</code></pre> <p>500 Response</p> <pre><code>{\n\"statusCode\": 500,\n\"error\": \"error_message\"\n}\n</code></pre>"},{"location":"developer-guide/api/#list-dataset-items-by-dataset-name-responses","title":"Responses","text":"Status Meaning Description Schema 200 OK Successful response Inline 500 Internal Server Error Error response Inline"},{"location":"developer-guide/api/#list-dataset-items-by-dataset-name-responseschema","title":"Response Schema","text":"To perform this operation, you must be authenticated by means of one of the following methods: api_key"},{"location":"developer-guide/source/","title":"Source code","text":"<p>Visit our GitHub repository to download the templates and scripts for this solution. The Extension for Stable Diffusion on AWS template is generated using the AWS Cloud Development Kit (CDK). Refer to the README.md file for additional information.</p>"},{"location":"plan-deployment/quotas/","title":"Quotas","text":"<p>To increase the quota of the Amazon SageMaker resources in your AWS account, you can follow these steps:</p> <ol> <li>Log in to the AWS Management Console and navigate to the Service Quotas console.</li> <li>Select AWS services from the navigation panel.</li> <li>Select Amazon SageMaker from the list, or type the service name in the search box.</li> <li>Request a quota increase: If the quota is adjustable, you can select the button or name, then select Request quota increase.</li> <li>Change the quota value: Enter the new value in the Change quota value field. The new value must be greater than the current value.</li> <li> <p>Submit the request: Click Request to submit your quota increase request to AWS.</p> <p>Notice</p> <p>Please note that some AWS services may only be available in certain regions. If you have quota increase requests in different regions, make sure to first select the appropriate region.</p> </li> </ol> <p>After you submit a quota increase request, you can track its status:</p> <ol> <li>View the request status: Return to the Service Quotas console and select Dashboard from the navigation panel. For pending requests, select the status of the request to open the request receipt. The initial status of the request is Pending. When the status changes to Quota Requested, you will see a case number at AWS Support. Select the case number to open your request receipt.</li> <li> <p>Check the quota request history: To view any pending or recently resolved requests, select Quota request history from the Service Quotas console navigation panel.</p> <p>Notice</p> <p>Kindly be noticed that quota increase requests do not receive priority support and may take some time to process. If you have an urgent request, consider contacting AWS Support directly.</p> </li> </ol> <p>Please refer to the following AWS documents for more information about quotas:</p> <ul> <li>Amazon SageMaker Service Quotas</li> <li>Requesting a Quota Increase</li> </ul>"},{"location":"plan-deployment/regions/","title":"Supported regions","text":"<p>As of June 2023, this solution is supported in the following Amazon Web Services Regions:</p> <ul> <li>us-east-1 (Virginia)</li> <li>us-east-2 (Ohio)  </li> <li>us-west-1 (N. California)</li> <li>us-west-2 (Oregon)  </li> <li>ca-central-1 (Canada) </li> <li>sa-east-1 (Sao Paulo)</li> <li>eu-west-1 (Ireland)</li> <li>eu-west-2 (London)</li> <li>eu-west-3 (Paris)   </li> <li>eu-central-1 (Frankfurt)  </li> <li>eu-north-1 (Stockholm)</li> <li>ap-northeast-1 (Tokyo) </li> <li>ap-northeast-2 (Seoul)  </li> <li>ap-northeast-3 (Osaka)</li> <li>ap-southeast-1 (Singapore)  </li> <li>ap-southeast-2 (Sydney)   </li> <li>ap-south-1 (Mumbai)  </li> <li>ap-east-1 (Hong Kong)</li> </ul> <p>Notice</p> <p>Recently, it's observed that newly created Amazon S3 bucket, in us-east-2, us-west-1, us-west-2, there is an issue with CORS that prevents users from uploading configuration files through the browser. Despite updating the CORS configuration, users frequently encounter CORS issues when uploading files using pre-signed URLs. The problem resolves itself after approximately two hours. We are currently in communication with the Amazon S3 Service team regarding this issue. According to that, it's recommended to deploy the solution in us-east-1, ap-northeast-1 or ap-southeast-1.</p>"},{"location":"plan-deployment/security/","title":"Security","text":"<p>When you build systems on AWS infrastructure, security responsibilities are shared between you and AWS. This shared model reduces your operational burden because AWS operates, manages, and controls the components including the host operating system, the virtualization layer, and the physical security of the facilities in which the services operate. For more information about AWS security, visit AWS Cloud Security.</p>"},{"location":"plan-deployment/security/#iam-roles","title":"IAM roles","text":"<p>AWS Identity and Access Management (IAM) roles allow customers to assign granular access policies and permissions to services and users on the AWS Cloud. This solution creates IAM roles that grant the solution\u2019s access between the solution components.</p>"},{"location":"plan-deployment/security/#security-groups","title":"Security groups","text":"<p>The security groups created in this solution are designed to control and isolate network traffic between the solution components. We recommend that you review the security groups and further restrict access as needed once the deployment is up and running.</p>"},{"location":"solution-overview/concepts/","title":"Concepts","text":"<p>This section describes key concepts and defines terminology specific to this solution: </p>"},{"location":"solution-overview/features-and-benefits/","title":"Features and benefits","text":""},{"location":"solution-overview/features-and-benefits/#features","title":"Features","text":"<p>This solution supports the cloud-based operations of the following native features/third-party extensions of Stable Diffusion WebUI:</p> Feature Supported Version Note Stable Diffusion WebUI V1.5.1 Support Stable Diffusion XL 1.0 img2img V1.5.1 Support all features except batch txt2img V1.5.1 LoRa V1.2.1 ControlNet V1.1.233 Dreambooth V1.0.14 Image browser Latest"},{"location":"solution-overview/features-and-benefits/#benefits","title":"Benefits","text":"<ul> <li> <p>Convenient Installation: This solution leverages CloudFormation for easy deployment of AWS middleware. Combined with the installation of the native Stable Diffusion WebUI (WebUI) features and third-party extensions, users can quickly utilize Amazon SageMaker's cloud resources for inference, training and finetuning tasks.</p> </li> <li> <p>Community Native: This solution is implemented as an extension, allowing users to seamlessly use their existing WebUI without any changes. Additionally, the solution's code is open source and follows a non-intrusive design, enabling users to keep up with community-related feature iterations, such as popular plugins like Dreambooth, ControlNet, and LoRa.</p> </li> <li> <p>High Scalability: This solution decouples the WebUI interface from the backend, allowing the WebUI to launch on supported terminals without GPU restrictions. Existing training, inference, and other tasks can be migrated to Amazon SageMaker through the provided extension functionalities, providing users with elastic computing resources, cost reduction, flexibility, and scalability.</p> </li> </ul>"},{"location":"solution-overview/use-cases/","title":"Use cases","text":"<p>"},{"location":"user-guide/CloudAssetsManage/","title":"Main Tab","text":"<p>This chapter will provide a detailed overview of the convenient cloud-based resource management approach offered by this solution.</p>"},{"location":"user-guide/CloudAssetsManage/#upload-model","title":"Upload Model","text":"<p>To use extra models for inference, you could upload model through steps below in two ways, and follow steps in txt2img or img2imgto inference with extra models as need.</p> <p>Method One: 1. Within Stable Diffusion WebUI, navigate to solution main tab Amazon SageMaker, find session Cloud Assets Management.  2. Select the Upload Model to S3 from WebUI drop-down box, which means to upload the model from the models file path where the WebUI service is deployed. 3. Enter the model path where the WebUI service is deployed under corresponding model text box.</p> <p>Note: You can upload multiple kinds of models by entering multiple local model paths in text box. 4. Click Upload Models to Cloud to start uploading process. 5.Message will appear on left right once uploading completes.</p> <p>Method Two: 1. Within Stable Diffusion WebUI, navigate to solution main tab Amazon SageMaker, find session Cloud Assets Management.  2. Select the Upload Model to S3 from Laptop drop-down box, which means to upload the model from the local path to access the WebUI. 3. Select the type of model to upload, currently supports six types: SD Checkpoints, Textual Inversion, LoRA model, ControlNet model, Hypernetwork, VAE 3. Select the model file to be uploaded locally.</p> <p>Note: You can select models multiple, but subject to browser restrictions, it is best to select no more than 10 files, and the total size should not exceed 8g. 4. Click Upload Models to Cloud to start uploading process. 5. The upload will be uploaded in pieces asynchronously based on the file size and quantity. After each piece is uploaded, you will see a prompt under the Choose File button</p>"},{"location":"user-guide/CloudAssetsManage/#amazon-sagemaker-endpoint-management","title":"Amazon SageMaker Endpoint Management","text":""},{"location":"user-guide/CloudAssetsManage/#deploy-new-endpoint","title":"Deploy new endpoint","text":"<ol> <li>Navigate to the Amazon SageMaker main tab of the solution. In the Cloud Assets Management module, locate the Deploy New SageMaker Endpoint section.</li> <li>The default deployment type for the solution is ml.g5.2xlarge, with 1 instance. The endpoint autoscaling feature is enabled by default. Simply click the Deploy button to initiate the deployment of the Sagemaker endpoint.</li> <li>If users wish to specify the endpoint name, instance type, and maximum instance count for the endpoint's instances, they can check the Advanced Endpoint Configuration checkbox. This will display additional parameters for user input. The following table lists the names and descriptions of these parameters:</li> </ol> Parameter Name Description Endpoint Name (Optional) If you need to specify a name for the Sagemaker endpoint, enter it in this input box. If not modified, the default endpoint name will be infer-endpoint-XXXXX. Instance Type Select the instance type for the deployed endpoint from the dropdown list. Max Instance Count Choose the maximum number of instances for the deployed endpoint from the dropdown list. If Autoscaling is selected, Sagemaker will elastically scale between 0 and the Max Instance Count based on average CPU usage. Enable Autoscaling If this checkbox is selected, Sagemaker will elastically scale between 0 and the Max Instance Count based on average CPU usage. Otherwise, the instance count for the endpoint will remain fixed at the Max Instance Count. <ol> <li> <p>After selecting the default endpoint configuration or setting up the advanced endpoint configuration, click Deploy. You'll see a message indicating Endpoint deployment started on the left side under Label.    </p> </li> <li> <p>You can navigate to tab txt2img, session Amazon SageMaker Inference, refresh and select drop down list Select Cloud SageMaker Endpoint to check all the deployment status of endpoints.</p> <p>Note: The format of the drop down list is\uff1aendpoint name+ deployment status (including Creating/Failed/InService)+deployment completing time.</p> </li> <li> <p>It will take around 10 mins for endpoint deployment status changing to InService, which indicates that the endpoint has been successfully deployed.</p> </li> </ol>"},{"location":"user-guide/CloudAssetsManage/#delete-deployed-endpoints","title":"Delete deployed endpoints","text":"<ol> <li>Refresh and select endpoint(s) under dropdown list of Select Cloud SageMaker Endpoint.</li> <li>Click Delete, message Endpoint delete completed will appear on left side, which indicates that the selected endpoint(s) havs been successfully deleted.</li> </ol>"},{"location":"user-guide/CloudAssetsManage/#aws-dataset-management","title":"AWS Dataset Management","text":""},{"location":"user-guide/CloudAssetsManage/#create-dataset","title":"Create Dataset","text":"<p>In functions such as model fine-tuning, it is necessary to provide a file of images for fine-tuning work. This functional module helps users quickly upload images to the cloud.</p> <ol> <li> <p>Navigate to main tab Amazon SageMaker, section AWS Dataset Management\uff0csub-tab Create. </p> </li> <li> <p>Click Click to Upload a File, in the local file browser that pops up, confirm to select all the images required for one model fine-tuning.</p> </li> <li>Enter file name in Dataset Name, enter file description in Dataset Description, click Create Dataset.</li> <li>The message Complete Dataset XXXX creation will be displayed on the right side once the process completes.</li> </ol>"},{"location":"user-guide/CloudAssetsManage/#explore-dataset","title":"Explore Dataset","text":"<p>After the dataset has been successfully uploaded, this feature module allows users to quickly obtain the corresponding cloud-based address of the dataset. Users can copy this address and paste it into the location where the collection of images needs to be uploaded.</p> <ol> <li>Navigate to Amazon SageMaker\uff0cAWS Dataset Management session\uff0cBrowse tab, refresh the list Dataset From Cloud and select desired dataset.</li> <li>Field dataset s3 location will display the corresponding S3 path on the cloud. User can copy to use as need.</li> </ol>"},{"location":"user-guide/controlnet-guide/","title":"Use Controlnet for inferencing","text":"<p>You can open controlnet sub-session, by combining the use of native functionalities txt2img or img2img along with the added panel of Amazon SageMaker Inference in the solution, the inference tasks involving cloud resources can be invoked.</p>"},{"location":"user-guide/controlnet-guide/#controlnet-user-guide","title":"Controlnet User Guide","text":""},{"location":"user-guide/controlnet-guide/#multi-controlnet-user-guide","title":"Multi-controlnet user guide","text":"<ol> <li> <p>Navigate to Settings tab. In the left sidebar, select ControlNet, and adjust the Multi ControlNet in the right panel: Max models amount (requires restart) setting to specify the number of ControlNets (1-10). Afterward, restart the webUI for the changes to take effect, and the Multi ControlNet configuration will be active. </p> </li> <li> <p>Navigate to txt2img or img2img tab\uff0can equal number of ControlNet units will appear. For example, below shows 3 controlNet units started simultaneously. </p> </li> </ol>"},{"location":"user-guide/controlnet-guide/#openpose-user-guide","title":"openpose User Guide","text":"<ol> <li>Open ControlNet panel, choose ControlNet Unit 0, check Enable, select openpose from Preprocessor, and then upload am image. </li> <li>Similar to local inference, you can customize the inference parameters of the native ControlNet. The controlnet model \"control_openpose-fp16.safetensors\" should be uploaded to the cloud before generate. </li> <li>Click Generate on Cloud after finished all parameters setting.</li> <li>Refresh and select the top Inference Job from Inference Job: Time-Type-Status-Uid, inference result will be displayed in Output section.</li> <li>Subsequent actions. You can click Save or others as need to perform further processing. </li> </ol>"},{"location":"user-guide/dreambooth-guide/","title":"Dreambooth Guide","text":"<p>You can open Dreambooth tab, by combining the use with native Dreambooth, the tab Create from Cloud and Select from Cloud that newly added by the solution, you can achieve  cloud-based model creating and training in Dreambooth.</p>"},{"location":"user-guide/dreambooth-guide/#create-model","title":"Create Model","text":"<ol> <li>Open Dreambooth tab, Model subtab Create From Cloud. </li> <li> <p>Enter a model name in the Name text box.</p> <p>Notice</p> <p>Please note the naming format requirements: the name can only contain alphanumeric characters and dashes (\"-\").</p> </li> <li> <p>Select one checkpoint under Source Checkpoint dropdown list.</p> <p>Note\uff1a The checkpoint files here include two sources: files starting with \"local\" are locally stored checkpoint files, while those starting with \"cloud\" are checkpoint files stored on Amazon S3. For first-time use, it is recommended to select a local checkpoint file.</p> </li> <li> <p>Click Create Model From Cloud to start model creation on cloud. Model Creation Jobs Details field will instantly update with the progress of the model creation job. When the status changes to Complete, it indicates that the model creation is finished.</p> </li> </ol>"},{"location":"user-guide/dreambooth-guide/#train-model","title":"Train Model","text":"<ol> <li>Open Dreambooth tab, Model subtab, Select From Cloud.</li> <li>Fresh and select the model from Model dropd down list that need to train.</li> <li> <p>Set corresponding parameters in Input session.</p> <ul> <li>Set training parameters<ul> <li>Checking Lora can accelerate the training process.</li> <li>The Training Steps Per Image (Epochs) represents the number of iterations for training a single image and can be left at the default value.  </li> </ul> </li> <li>Set the concepts that need to be trained. A total of four concepts can be set, and we will use the first concept as an example.<ul> <li>In the Dataset Directory field, enter the path to the images required for training. It can be a path on a web server or an S3 path. For S3 paths, you can obtain them by uploading the data through AWS Dataset Management or by uploading them to S3 on your own. The path should start with \u201cs3://\".</li> <li>In the Instance Prompt section under Training Prompts, enter the keywords for the concept. These keywords will be used to generate the concept during the training process in txt2img. Therefore, avoid using common English words (as they might get confused with other concepts in the base model).</li> </ul> </li> </ul> <p> </p> <ul> <li>You need to check Save Checkpoint to Subdirectory to save the model to a subdirectory. In addition, it is not supported to save the Lora model separately. Please don't check Generate lora weights for extra networks.</li> </ul> </li> <li> <p>Click SageMaker Train to start model training task. The Training Job Details section will be updated in real-time with the status of the model training job. When the status changes to Complete, an email notification will be sent to the email address provided during the initial deployment of the solution, indicating that the model training is complete.</p> </li> <li>Future steps. For example: Navigate to txt2img tab Amazon SageMaker Inference panel, check trained model by refreshing Stable Diffusion Checkpoint dropdown list.  </li> </ol>"},{"location":"user-guide/endpoint-autoscaling/","title":"SageMaker Async Endpoint Autoscaling","text":"<p>Amazon SageMaker provides capabilities to automatically scale model inference endpoints in response to the changes in traffic patterns. This document explains how autoscaling is enabled for an Amazon SageMaker async endpoint created by this Solution</p>"},{"location":"user-guide/endpoint-autoscaling/#overview","title":"Overview","text":"<p>The solution provided enables autoscaling for a specific endpoint and variant in Amazon SageMaker. Autoscaling is managed through two scaling policies:</p> <ol> <li>Target Tracking Scaling Policy: This policy adjusts the desired instance count based on the <code>CPUUtilization</code> metric. It aims to keep the CPU utilization at 50%. If the average CPU utilization is above 50 for 5 minutes, the alarm will trigger application autoscaling to scale out Sagemaker endpoint until it reach the maximum number of instances.</li> </ol> <p>The scaling policy based on CPU utilization is defined using the <code>put_scaling_policy</code> method. It specifies the following parameters:     - <code>TargetValue</code>: 50% CPU utilization     - <code>ScaleInCooldown</code>: 300 seconds     - <code>ScaleOutCooldown</code>: 300 seconds</p> <ol> <li>Step Scaling Policy: This policy allows you to define steps for scaling adjustments based on the <code>HasBacklogWithoutCapacity</code> metric. This policy is created to let application autoscaling increase the instance number from 0 to 1 when there is inference request but endpoint has 0 instance.</li> </ol> <p>The step scaling policy is defined to adjust the capacity based on the <code>HasBacklogWithoutCapacity</code> metric. It includes: - <code>AdjustmentType</code>: ChangeInCapacity - <code>MetricAggregationType</code>: Average - <code>Cooldown</code>: 300 seconds - <code>StepAdjustments</code>: Specifies the scaling adjustments based on the size of the alarm breach.</p>"},{"location":"user-guide/endpoint-autoscaling/#example-of-sagemaker-async-endpoint-autoscaling-policy-below","title":"Example of Sagemaker async endpoint autoscaling policy below:","text":"<pre><code>{\n\"ScalingPolicies\": [\n{\n\"PolicyARN\": \"Your PolicyARN\",\n\"PolicyName\": \"HasBacklogWithoutCapacity-ScalingPolicy\",\n\"ServiceNamespace\": \"sagemaker\",\n\"ResourceId\": \"endpoint/infer-endpoint-c356f91/variant/prod\",\n\"ScalableDimension\": \"sagemaker:variant:DesiredInstanceCount\",\n\"PolicyType\": \"StepScaling\",\n\"StepScalingPolicyConfiguration\": {\n\"AdjustmentType\": \"ChangeInCapacity\",\n\"StepAdjustments\": [\n{\n\"MetricIntervalLowerBound\": 0.0,\n\"ScalingAdjustment\": 1\n}\n],\n\"Cooldown\": 300,\n\"MetricAggregationType\": \"Average\"\n},\n\"Alarms\": [\n{\n\"AlarmName\": \"stable-diffusion-hasbacklogwithoutcapacity-alarm\",\n\"AlarmARN\": \"Your AlarmARN\"\n}\n],\n\"CreationTime\": \"2023-08-14T13:53:10.480000+08:00\"\n},\n{\n\"PolicyARN\": \"Your PolicyARN\",\n\"PolicyName\": \"CPUUtil-ScalingPolicy\",\n\"ServiceNamespace\": \"sagemaker\",\n\"ResourceId\": \"endpoint/infer-endpoint-c356f91/variant/prod\",\n\"ScalableDimension\": \"sagemaker:variant:DesiredInstanceCount\",\n\"PolicyType\": \"TargetTrackingScaling\",\n\"TargetTrackingScalingPolicyConfiguration\": {\n\"TargetValue\": 50.0,\n\"CustomizedMetricSpecification\": {\n\"MetricName\": \"CPUUtilization\",\n\"Namespace\": \"/aws/sagemaker/Endpoints\",\n\"Dimensions\": [\n{\n\"Name\": \"EndpointName\",\n\"Value\": \"infer-endpoint-c356f91\"\n},\n{\n\"Name\": \"VariantName\",\n\"Value\": \"prod\"\n}\n],\n\"Statistic\": \"Average\",\n\"Unit\": \"Percent\"\n},\n\"ScaleOutCooldown\": 300,\n\"ScaleInCooldown\": 300\n},\n\"Alarms\": [\n{\n\"AlarmName\": \"TargetTracking-endpoint/infer-endpoint-c356f91/variant/prod-AlarmHigh-c915b303-9048-40b2-99a7-f5b7e49ab7c4\",\n\"AlarmARN\": \"Your AlarmARN\"\n},\n{\n\"AlarmName\": \"TargetTracking-endpoint/infer-endpoint-c356f91/variant/prod-AlarmLow-2fd61f99-c2e5-4ac6-9722-54030c3f0216\",\n\"AlarmARN\": \"Your AlarmARN\"\n}\n],\n\"CreationTime\": \"2023-08-14T13:53:10.182000+08:00\"\n}\n]\n}\n</code></pre>"},{"location":"user-guide/img2img-guide/","title":"img2img Guide","text":"<p>You can open the img2img tab and use the original region along with the Amazon SageMaker Inference to perform inference on the cloud.</p>"},{"location":"user-guide/img2img-guide/#img2img-user-guide","title":"img2img user guide","text":""},{"location":"user-guide/img2img-guide/#standard-process-for-different-functional-labels-in-img2img","title":"Standard process for different functional labels in img2img","text":"<ol> <li>Navigate to tab img2img, find panel Amazon SageMaker Inference.</li> <li> <p>Input parameters for inference. The same as local inferance, you could edit parameters in native fields for model name (stable diffusion checkpoint, extra networks:Lora, Hypernetworks, Textural Inversion and VAE), prompts, negative prompts, sampling parameters, inference parameters and etc. For functions img2img, sketch, inpaint, inpaint sketch and inpaint upload, you could upload and modify images in the native way.</p> <p>Notice</p> <p>The model files used in the inferece should be uploaded to the cloud before generate, which can be refrred to the introduction of chapter Cloud Assets Management</p> <ol> <li>Select the inference endpoint. Click the refresh button on the right side of Select Cloud SageMaker Endpoint to choose an inference endpoint that is in the InService state. After select one InService endpoint, the button Generate will change to button Generate on Clound\u3002 </li> </ol> <p>Notice</p> <p>This field is mandatory. If you choose an endpoint that is in any other state or leave it empty, an error will occur when you click Generate on Cloud to initiate cloud-based inference.</p> </li> <li> <p>ClickGenerate on Cloud\u3002</p> </li> <li>Check inference result. Fresh and select the top option among Inference Job: Time-Type-Status-Uuid dropdown list. The Output section in the top-right area of the img2img tab will display the results of the inference once completed, including the generated images, prompts, and inference parameters. Based on this, you can perform subsequent workflows such as clicking Save or Send to extras. <p>Note: The list is sorted in reverse chronological order based on the inference time, with the most recent inference task appearing at the top. Each record is named in the format of inference time -&gt; job type(txt2img/img2img/interrogate_clip/interrogate_deepbooru) -&gt; inference status(succeed/in progress/fail) -&gt;inference id.</p> </li> </ol>"},{"location":"user-guide/img2img-guide/#img2img-label","title":"img2img label","text":"<ol> <li>Upload the original image to img2img and enter prompts, and click Generate on Cloud.</li> <li>Select corresponding Inference Job ID, the generated image will present on the right Output session. </li> </ol>"},{"location":"user-guide/img2img-guide/#sketch-label","title":"Sketch label","text":"<ol> <li>Start Stable Diffusion WebUI with \u2018--gradio-img2img-tool color-sketch\u2019 on the command line\uff0cupload the whiteboard background image to the Sketch tab.</li> <li> <p>Use a brush to draw the corresponding sketch and prepare prompts, and click Generate on Cloud. </p> </li> <li> <p>Select corresponding Inference Job ID, the generated image will present on the right Output session. </p> </li> </ol>"},{"location":"user-guide/img2img-guide/#inpaint-label","title":"Inpaint label","text":"<ol> <li>Upload original image to Inpaint label.</li> <li> <p>Establish masks with brushes and prepare prompts, and click Generate on Cloud. </p> </li> <li> <p>Select corresponding Inference Job ID, the generated image will present on the right Output session. </p> </li> </ol>"},{"location":"user-guide/img2img-guide/#inpaint-sketch-label","title":"Inpaint Sketch label","text":"<ol> <li>Start Stable Diffusion WebUI with \u2018--gradio-img2img-tool color-sketch\u2019\uff0cand upload original image into Inpaint Sketchlabel with prompts.</li> <li> <p>Establish masks with brushes, and click Generate on Cloud. </p> </li> <li> <p>Select corresponding Inference Job ID, the generated image will present on the right Output session. </p> </li> </ol>"},{"location":"user-guide/img2img-guide/#inpatnt-upload-label","title":"Inpatnt Upload label","text":"<ol> <li> <p>Upload original image and mask image to Inpaint Upload label and prepare prompts, for example large eyes. </p> </li> <li> <p>Click Generate on Cloud, and select corresponding Inference Job ID, the generated image will present on the right Output session. </p> </li> </ol>"},{"location":"user-guide/img2img-guide/#interrogate-clipdeepbooru","title":"Interrogate clip/deepbooru","text":"<ol> <li>Navigate to img2img tab\uff0copen Amazon SageMaker Inference panel.</li> <li> <p>Interrogate only need to upload image to img2img tab. </p> </li> <li> <p>Select inference endpoint. Click refresh button on the right of Select Cloud SageMaker Endpoint, select one inference endpoint in InService state.</p> </li> <li>Click Interrogate CLIP on cloud or Interrogate DeepBooru on cloud.</li> <li>Check inference result. Refresh the dropdown list of Inference Job JDs, check the topmost Inference Job ID that match the inference submission timestamp to review the inference result. </li> </ol>"},{"location":"user-guide/img2img-guide/#continuous-inference-scenario","title":"Continuous Inference Scenario","text":"<ol> <li>Following the General Inference Scenario, complete the parameter inputs and click Generate on Cloud to submit the initial inference task.</li> <li>Wait for the appearance of a new Inference ID in the right-side Output section.</li> <li>Once the new Inference ID appears, you can proceed to click Generate on Cloud again for the next inference task. </li> </ol>"},{"location":"user-guide/preparation/","title":"Connet Stable Diffusion WebUI with AWS Account","text":""},{"location":"user-guide/preparation/#prerequisites","title":"Prerequisites","text":"<p>You need to have successfully completed the deployment of the solution.</p>"},{"location":"user-guide/preparation/#steps","title":"Steps","text":"<ol> <li>Visit AWS CloudFormation Console.</li> <li>Select the root stack of the solution you created from stack list, rather than the nested stacks. The nested stacks will be indicated as 'NESTED' next to their names in the list.</li> <li>Open Outputs tab, find URL of APIGatewayUrl and copy\u3002</li> <li>Open Stable Diffusion WebUI, nagivate to Amazon SageMakertab\uff0cpaste the URL copied from step 3 under API URL. Paste API token copied from step 3 into field of API Token. Click Update Setting\uff0cconfig updated to local config! message will appear. </li> <li>Click Test Connection, Successfully Connected message will appear, which indicates that Stable Diffusion WebUI has been successfully connected with AWS account of the backend deployed stack.</li> </ol>"},{"location":"user-guide/txt2img-guide/","title":"txt2img Guide","text":"<p>You can open the txt2img tab to perform text-to-image inference using the combined functionality of the native region of txt2img and the newly added \"Amazon SageMaker Inference\" panel in the solution. This allows you to invoke cloud resources for txt2img inference tasks.</p>"},{"location":"user-guide/txt2img-guide/#txt2img-user-guide","title":"txt2img user guide","text":""},{"location":"user-guide/txt2img-guide/#general-inference-scenario","title":"General Inference Scenario","text":"<ol> <li>Navigate to txt2img tab, find Amazon SageMaker Inference panel.  </li> <li> <p>Enter the required parameters for inference. Similar to local inference, you can customize the inference parameters of the native txt2img, including model name (stable diffusion checkpoint, extra networks:Lora, Hypernetworks, Textural Inversion and VAE), prompts, negative prompts, sampling parameters, and inference parameters. For VAE model switch, navigate to Settings tab, select Stable Diffusion in the left panel, and then select VAE mdoel in SD VAE (choose VAE model: Automatic = use one with same filename as checkpoint; None = use VAE from checkpoint). </p> <p>Notice</p> <p>The model files used in the inferece should be uploaded to the cloud before generate, which can be refrred to the introduction of chapter Cloud Assets Management. The current model list displays options for both local and cloud-based models. For cloud-based inference, it is recommended to select models with the sagemaker keyword as a suffix, indicating that they have been uploaded to the cloud for subsequent inference.</p> </li> <li> <p>Select an endpoint for inference. Refresh and select an endpoint from Select Cloud SageMaker Endpoint dropdown list that is in the InService state. After select one InService endpoint, the button Generate will change to button Generate on Clound\u3002 </p> <p>Notice</p> <p>This field is mandatory. If you choose an endpoint that is in any other state or leave it empty, an error will occur when you click Generate on Cloud to initiate cloud-based inference.</p> </li> <li> <p>Finish setting all the paramters, and then click Generate on Cloud.</p> </li> <li> <p>Check inference result. Fresh and select the top option among Inference Job dropdown list, the Output section in the top-right area of the txt2img tab will display the results of the inference once completed, including the generated images, prompts, and inference parameters. Based on this, you can perform subsequent workflows such as clicking Save or Send to img2img.</p> <p>Note\uff1a The list is sorted in reverse chronological order based on the inference time, with the most recent inference task appearing at the top. Each record is named in the format of inference time -&gt; inference id.</p> </li> </ol> <p></p>"},{"location":"user-guide/txt2img-guide/#continuous-inference-scenario","title":"Continuous Inference Scenario","text":"<ol> <li>Following the General Inference Scenario, complete the parameter inputs and click Generate on Cloud to submit the initial inference task.</li> <li>Wait for the appearance of a new Inference IDin the right-side \"Output\" section.</li> <li>Once the new Inference ID appears, you can proceed to click Generate on Cloud again for the next inference task.</li> </ol>"},{"location":"user-guide/txt2img-guide/#inference-job","title":"Inference Job","text":"<p>Inference Job displays latest 10 inference job by default, following naming format Time-Type-Status-Uuid. Checking Show All will display all inference jobs the account has. Checking Advanced Inference Job filter and apply filters as need will provide users customorized infenrence job list.</p>"}]}